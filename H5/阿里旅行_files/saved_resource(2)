KISSY.add("h5-home/pages/home/index",function(t,require,e,i){"use strict";var n=require("ua"),s=require("./dbl11"),a=require("./util"),r=require("./city"),o=require("./data"),c=require("./view"),h=t.merge(r,o,c,{init:function(){var t=this;s.init(),this.registerJuicer(),this.bindHeaderScroll(),this.checkSupportWebp(function(e){t.isSupportWebp=e,t.bindPageShow(),t.bindCityChange(function(e){t.fetch(e).then(function(i){t.render(i),2==t.renderCount&&t.sendPerfData(),t.fetchCrossSale(e).then(function(e){t.renderCrossSale(e)})})["catch"](function(t){location.href.match(/(waptest|wapa|dev|debug)/i)&&setTimeout(function(){if(KISSY.isError(t))throw t;t&&t.toString&&console.error(t.toString())},0)})},t),PerfTracker.timelineStart("\u9996\u6b21\u83b7\u53d6\u57ce\u5e02"),t.render(),t.bind(),t.getCity().then(function(e){addHomePerf("firstCity",e.cityName),addHomePerf("firstCityType",e.type),PerfTracker.timelineEnd("\u9996\u6b21\u83b7\u53d6\u57ce\u5e02","success",{city:encodeURIComponent(e.cityName),type:e.type}),t.setCity(e)},function(){PerfTracker.timelineEnd("\u9996\u6b21\u83b7\u53d6\u57ce\u5e02","failure")})}),window.addEventListener("beforeunload",function(){t.sendExposureDataToGoldLog()},!1)},bindPageShow:function(){function t(t){e.sendExposureDataToGoldLog();var i=e.CATEGORY_NEED_REFRESH;e.CATEGORY_NEED_REFRESH=!1,e.getCity(!0).then(function(t){e.setCity(t,i)})}var e=this;document.addEventListener("AlitripGetCityBack",t),document.addEventListener("resume",t),document.addEventListener("WV.Event.APP.Active",t,!1),document.addEventListener("WV.Event.Key.Back",t,!1),window.addEventListener("pageshow",function(e){e.persisted&&t(e)},!1),document.addEventListener("visibilitychange",function(e){"visible"!=document.visibilityState&&document.hidden||t(e)},!1),document.addEventListener("webkitVisibilitychange",function(e){"visible"!=document.webkitVisibilityState&&document.webkitHidden||t(e)},!1)},sendPerfData:function(){var e,i=window.ALITRIP_HOME_PERF,s=i.start,r=t.mix(n,{ua:navigator.userAgent,app:a.getApp(),offline:!!window._$isOffline$_,projectVersion:"0.2.167"}),o=[];for(e in i)"number"!=typeof i[e]||e.match(/Mod/)?r[e]=i[e]:r[e]=i[e]-s;r.fetchTime=r.fetchEnd-r.fetchStart,r.fetchLayoutTime=r.fetchLayoutEnd-r.fetchLayoutStart,r.locateCityStart&&r.locateCityEnd&&(r.locateCityTime=r.locateCityEnd-r.locateCityStart);for(e in r)"undefined"!=typeof r[e]?o.push(e+"="+encodeURIComponent(r[e])):delete r[e];console.log(r),window.MT&&MT.Tracker&&(o=o.join("&"),MT.Tracker.sendGoldLog("tbtrip.713.1","H46807174",o))}});window.setHomeCity=function(t,e){location.href.match(/(waptest|wapa|dev|debug)/i)&&h.setCity({cityName:t,cityCode:"",cityEllipsis:t,capital:"",area:"",type:e||"select",time:Date.now()})},i.exports=h});KISSY.add("h5-home/pages/home/dbl11",function(t,require,e,i){var n=require("q"),s=require("mtop"),a=require("juicer"),r=require("jsbridge"),o=require("./util"),c='<div data-spm="1998727093" class="dbl11-tabbar dbl11-mod"><a href="${url}"><img src="${image}" /></a></div>',h='<div data-spm="1998727094" class="dbl11-splash dbl11-mod"><div><a href="${href}" data-href="${href}"><img src="${image}" data-src="${bgimage}" /></a><span class="dbl11-splash-close" data-spm-click="gostr=/tbtrip;locaid=d02;"></span></div></div>',l='<div data-spm="1998727095" class="dbl11-entry dbl11-mod"><a href="${href}"><img src="//gw.alicdn.com/tps/TB1Cbs.JFXXXXXnXpXXXXXXXXXX-160-160.gif" /></a></div>',u='<div data-spm="1998727096" class="dbl11-entry-act dbl11-mod" data-key="${currentKey}"><a href="${href}"><span>${actText}</span></a></div>',d=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()});i.exports={init:function(){this.checkSupportWebp(function(e){this.isSupportWebp=e,this.fetchResource().then(t.bind(this.renderResource,this),t.bind(this.handleResourceError,this))},this)},fetchResource:function(){var t=this,e=n.defer();return s.request({api:"mtop.trip.activity.queryTMSResources",v:"1.0",data:{clientPlatform:"h5",resourceHolderNames:JSON.stringify(["home_tabbar","home_activity_entry","home_activity_entry_activities","realtime_splash_data60"])}}).then(function(i){i&&i.data&&t.checkResource(i.data)?e.resolve(i.data):e.reject("\u83b7\u53d6\u53cc\u5341\u4e00\u6570\u636e\u5931\u8d25")},function(t){e.reject("\u83b7\u53d6\u53cc\u5341\u4e00\u6570\u636e\u5931\u8d25")}),e.promise},hasResource:function(t,e){return t.has=t.has||{},t[e]&&t[e].banner&&t[e].banner.length?(t.has[e]=!0,!0):!1},checkResource:function(t){var e=!1;return this.hasResource(t,"home_tabbar")&&(e=!0),this.hasResource(t,"home_activity_entry")&&(e=!0,this.hasResource(t,"home_activity_entry_activities")&&this.parseEntryActResource(t.home_activity_entry_activities)),this.hasResource(t,"realtime_splash_data60")&&(e=!0),e},parseEntryActResource:function(e){var i,n=e.timestamp||Date.now(),s=d(Date.now()),a=o.getStorage("ALITRIP_H5_HOME_DBL11_ENTRY_ACT",!0),r=a&&a.keys,c=e.banner,h=0;for(e.now=n;h<c.length;)i=c[h],i.href=i.href_h5||i.href,i.href=i.href.replace(/^http(s?):/,""),i.start=new Date(i.activityStartTime.replace(/-/g,"/")).getTime(),i.last=Math.round(60*parseFloat(i.activityOngoingTime)*1e3),i.end=i.start+i.last,i.countDownStartTime&&(i.preLast=Math.round(60*parseFloat(i.countDownStartTime)*1e3),i.preStart=i.start-i.preLast),(!i.href||!i.start||!i.end||n>i.end-1e4||a&&a.t===s&&r&&t.inArray(i.currentKey,r))&&(c.splice(h,1),h--),h++;e.banner=c.sort(function(t,e){return t.start>e.start?1:t.start<e.start?-1:0}),this.entryActData=e},getCurrentActItem:function(t){for(var e,i,n,s=t.timestamp||Date.now(),a=t.banner,r=0,o=a.length;o>r;r++)if(e=a[r],i=new Date(e.from.replace(/-/g,"/")).getTime(),n=new Date(e.to.replace(/-/g,"/")).getTime(),i&&n&&s>=i&&n>=s)return e;return null},renderResource:function(t){t.has.home_tabbar&&this.renderTabBar(t.home_tabbar),t.has.realtime_splash_data60&&this.renderSplash(t.realtime_splash_data60),t.has.home_activity_entry&&this.renderEntry(t.home_activity_entry,t.has.home_activity_entry_activities&&t.home_activity_entry_activities),this.bindResource()},handleResourceError:function(){console.log("\u83b7\u53d6\u53cc\u5341\u4e00\u6570\u636e\u5931\u8d25")},renderSplash:function(e){var i,n,s,r=(e.timestamp||Date.now(),d(Date.now())),c=o.getStorage("ALITRIP_H5_HOME_DBL11_SPLASH",!0),l=e.banner[0];if(l&&(l.href=l.href_h5||l.href,l.bgimage&&l.href)){if(l.bgimage=l.bgimage.replace(/^http(s?):/,""),c&&c.t===r&&c.images&&t.inArray(l.bgimage,c.images))return;l.image=l.bgimage+"_600x600q75.jpg",this.isSupportWebp&&(l.image+="_.webp"),s=new Image,s.onload=function(){i=a(h,l),n=t.one(i),t.one("body").append(n),s.onload=null,s=null},s.src=l.bgimage}},renderTabBar:function(e){var i,n=(e.timestamp||Date.now(),this.getCurrentActItem(e,"from","to"));if(n){try{n.config=JSON.parse(n.config)}catch(s){}n.config&&n.config.image&&n.config.url&&(n.config.image+="_q75.jpg",this.isSupportWebp&&(n.config.image+="_.webp"),i=a(c,n.config),t.one("body").append(i))}},renderEntry:function(e,i){var n,s=(e.timestamp||Date.now(),this.getCurrentActItem(e,"from","to"));s&&(s.href=(s.href_h5||s.href).replace(/^http(s?):/,""),s.href&&(n=a(l,s),t.one("body").prepend(n),t.one("body").addClass("dbl11-entry-enabled")),s.href&&i&&this.renderEntryAct(i))},renderEntryAct:function(t){this.localTime=Date.now(),this.showEntryAct()},showEntryAct:function(){var t,e,i=this,n=this.entryActData,s=n.banner,a=n.now+Date.now()-this.localTime;clearTimeout(this.showActTimer),clearTimeout(this.hideActTimer),clearTimeout(this.preActTimer),s.length&&(t=s.shift(),e=s.length>1?t[1]:null,a>=t.start?this.runExpandAnim(t):a>=t.preStart?this.runExpandAnim(t,!0):this.showActTimer=setTimeout(function(){i.runExpandAnim(t,!0)},t.preStart-a))},hideEntryAct:function(){clearTimeout(this.showActTimer),clearTimeout(this.hideActTimer),clearTimeout(this.preActTimer),this.runCallapseAnim(),this.showEntryAct()},runExpandAnim:function(e,i){var n=this,s=this.entryActData,r=s.now+Date.now()-this.localTime,o=t.one(".header .search"),c=a(u,{href:e.href.replace(/^http(s?):/,""),actText:i?e.activityInCountDownReminder:e.activityOnGoingReminder,currentKey:e.currentKey}),h=t.one(c),l=0;t.one("body").prepend(h),o&&(l=o.width()-22);var d=function(){h.detach("transitionend webkitTransitionEnd",d),h.addClass("dbl11-entry-act-expanded"),h.removeClass("dbl11-entry-act-expand"),h.one("span").show()};setTimeout(function(){h.on("transitionend webkitTransitionEnd",d),h.addClass("dbl11-entry-act-expand"),l>0&&h.width(l)},5),this.hideActTimer=setTimeout(function(){n.hideEntryAct()},e.end-r),i&&(this.preActTimer=setTimeout(function(){h.one("span").html(e.activityOnGoingReminder)},e.start-r))},runCallapseAnim:function(){var e=t.one(".dbl11-entry-act");if(e){var i=function(){e.detach("transitionend webkitTransitionEnd",i),e.removeClass("dbl11-entry-act-callapse"),e.remove()};e.one("span").hide(),e.on("transitionend webkitTransitionEnd",i),e.addClass("dbl11-entry-act-callapse"),e.width(10);var n=o.getStorage("ALITRIP_H5_HOME_DBL11_ENTRY_ACT",!0),s=d(Date.now()),a=[];n&&n.t===s&&(a=n.keys||[]),a.push(e.attr("data-key")),o.setStorage("ALITRIP_H5_HOME_DBL11_ENTRY_ACT",{t:s,keys:a},!0)}},bindResource:function(){var e=t.one("body");_preventScroll=function(t){t.preventDefault()},e.delegate("touchmove",".dbl11-splash",_preventScroll,this),e.delegate("tap click",".dbl11-entry-act",function(t){return"click"===t.type?void t.preventDefault():void this.hideEntryAct()},this),e.delegate("tap click",".dbl11-splash div",function(t){if("click"===t.type)return void t.preventDefault();var i=o.getStorage("ALITRIP_H5_HOME_DBL11_SPLASH",!0),n=d(Date.now()),s=[];i&&i.t===n&&(s=i.images||[]),s.push(t.currentTarget.querySelector("img").getAttribute("data-src")),o.setStorage("ALITRIP_H5_HOME_DBL11_SPLASH",{t:n,images:s},!0),e.detach("touchmove",".dbl11-splash",_preventScroll,this),"A"===t.target.nodeName||"IMG"===t.target.nodeName?setTimeout(function(){t.currentTarget.parentNode.parentNode.removeChild(t.currentTarget.parentNode)},16):t.currentTarget.parentNode.parentNode.removeChild(t.currentTarget.parentNode)},this),e.delegate("tap click",".dbl11-mod a",function(t){if("click"===t.type)return void t.preventDefault();var e=t.currentTarget.href;e&&(e=e.replace(/&?spm\=[0-9A-Za-z\.]+/gi,"").replace(/\?&/,"?").replace(/\?$/,""),r.goTo({href:e,triggerNode:t.currentTarget}))},this)},checkSupportWebp:function(t,e){var i,n,s=new Image;s.onload=s.onerror=function(){i||(i=!0,n=2===s.width&&2===s.height,t.call(e,n))},setTimeout(function(){i||(i=!0,n=!1,t.call(e,n))},16),s.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}}});KISSY.add("h5-home/pages/home/util",function(t,require,e,i){"use strict";function s(e,i){var s=r[e];return t.isArray(s)&&(s=s[0]),i?a.escaping(s||""):s||""}function n(e,i){r=e?t.unparam(location.hash.substring("undefined"==typeof i?2:i)):t.unparam(location.search.substring("undefined"==typeof i?1:i))}var r,a=(require("jsbridge"),require("lang"),require("uri"),{escapehash:{"<":"&lt",">":"&gt","&":"&amp",'"':"&quot","`":"&#x60","'":"&#x27","/":"&#x2f"},escapereplace:function(t){return a.escapehash[t]+";"},escaping:function(t){return"string"!=typeof t?t:t.replace(/[&<>"]/gim,this.escapereplace)},detection:function(t){return"undefined"==typeof t?"":t}}),o=document.createElement("a");n(),i.exports={escapeHTML:function(t){return a.escaping(t)},getParam:s,updateParams:n,getStorage:function(t,e){var i,s=window.localStorage||window.sessionStorage;try{i=s.getItem(t),e&&(i=JSON.parse(i))}catch(n){}return i},setStorage:function(t,e,i){var s=window.localStorage||window.sessionStorage;try{i&&(e=JSON.stringify(e)),s.setItem(t,e)}catch(n){}return e},getApp:function(){var t=navigator.userAgent;return t.match(/alitrip/i)?"alitrip":t.match(/alipay/i)?"alipay":t.match(/AliApp\(TB/i)?"taobao":t.match(/AliApp\(WX/i)?"wangxin":t.match(/AliApp\(TM/i)?"tmall":t.match(/AliApp/i)?"aliapp":t.match(/ucbrowser/i)?"uc":"other"},getUrlInfo:function(e){var i,s,n,r=["protocol","host","hostname","pathname","search","hash","origin","port","href"],a=location,h={};return e&&(o.href=e,a=o),t.each(r,function(t){h[t]=a[t]||""}),i=this.getCategory(h),s=this.getPage(i,h),n=this.getSubPage(i,s,h),t.mix(h,{category:i,page:s,subpage:n,pagename:[i,s,n].join("/")})},getCategory:function(t){var t=t||location,e=t.pathname.match(/\/trip\/([\w|-]+)\//i);return e&&e[1]||""},getPage:function(t,e){if(!t)return"";var e=e||location,i=new RegExp("\\/trip\\/"+t+"\\/([\\w|-]+)","i"),s=e.pathname.match(i),n=s&&s[1]||"";return n},getSubPage:function(t,e,i){if(!t||!e)return"";var i=i||location,s=new RegExp("\\/trip\\/"+t+"\\/"+e+"\\/([\\w|-]+).html","i"),n=i.pathname.match(s),r=n&&n[1]||"";return r},getVersion:function(t){var e=new RegExp(t+"[\\s\\/][\\d\\.]+","igm"),i=navigator.userAgent.match(e),s=i?i[0].match(/[\d\.]+/gim)[0]:"";return s},compareVersion:function(t,e,i){if(!t)return-1;for(var s,n,r=t.split("."),a=e.split("."),o=i||r.length,h=-1;++h<o;){if(s=Number(r[h])||0,n=Number(a[h])||0,s>n)return 1;if(n>s)return-1}return 0},addTtidAndSpm:function(t,e){if(window.MT&&window.MT.Tracker&&e){var i=window.MT.Tracker.getEelementABCDForStr(e),s=t.split("#"),n=s[0].split("?");if(n.length>1){var r=n[1];n[1]=r.replace(/&+spm\=[0-9A-Za-z\.]+/gi,"")}s[0]=n.join("?");var a=-1==s[0].indexOf("?")?"?":"&",o="spm="+i;if(s[0]=s[0]+a+o,-1==s[0].indexOf("ttid")){var h=this.getParam("ttid")||"",c="ttid="+h,a=-1==s[0].indexOf("?")?"?":"&";s[0]=s[0]+a+c}t=s.join("#")}return t}}});KISSY.add("h5-home/pages/home/city",function(t,require,e,i){"use strict";var s=require("q"),n=require("./util"),r=require("../../datas/city_map"),a=require("../../datas/city_data"),o=require("../../widgets/notification/"),h=require("../../widgets/geolocation/city");i.exports={currentCity:null,getCity:function(t){var e=this,i=s.defer(),n=this.getUrlCity(),r=this.getCacheCity();return t?r?i.resolve(r):i.reject("\u6ca1\u6709\u7f13\u5b58\u7684\u57ce\u5e02\u4fe1\u606f"):(n&&i.resolve(n),r&&i.resolve(r),this.getLocateCity().then(i.resolve),setTimeout(function(){i.resolve(e.getDefCity())},8e3)),i.promise},getDefCity:function(e){return t.merge({cityName:"",cityCode:"",cityEllipsis:"\u8bf7\u9009\u62e9",capital:"",area:"",type:"default",time:Date.now()},e)},getUrlCity:function(){var e=n.getParam("cityName",!0);return e?t.mix({cityName:e,cityCode:this.getCityCode(e),cityEllipsis:this.getCityEllipsis(e),time:Date.now(),type:"select"},this.getCityExt(e)):null},getCacheCity:function(){var e=n.getStorage("ALITRIP_H5_HOME_CACHE_CITY",!0);return(!e||e.cityName&&"[]"!==e.cityName&&"900000"!==e.cityCode)&&e?t.mix(e,{type:"cache"},this.getCityExt(e.cityName)):null},getLocateCity:function(){var e,i,r,a=this,o=s.defer(),c=n.getStorage("ALITRIP_H5_HOME_LOCATE_CITY",!0),l=12e5;return c&&c.cityName&&(o.resolve(c),Date.now()-c.time<l)?(setTimeout(function(){a.checkLocateCity(o,c)},200),o.promise):(setTimeout(function(){addHomePerf("locateCityStart"),PerfTracker.timelineStart("\u5b9a\u4f4d\u7ecf\u7eac\u5ea6"),i=new h({needCityCode:!0}),i.on("success",function(t){r={latitude:t.data.latitude||t.data.coords.latitude,longitude:t.data.longitude||t.data.coords.longitude},PerfTracker.timelineEnd("\u5b9a\u4f4d\u7ecf\u7eac\u5ea6","success",{app:n.getApp()}),PerfTracker.timelineStart("\u5b9a\u4f4d\u57ce\u5e02")}),i.on("failure",function(t){PerfTracker.timelineEnd("\u5b9a\u4f4d\u7ecf\u7eac\u5ea6","failure",{app:n.getApp(),type:t.data&&t.data.status||"",msg:t.data&&t.data.msg||""})}),i.on("citySuccess",function(i){e=t.merge(i.data,{cityEllipsis:this.getCityEllipsis(i.data.cityName),time:Date.now(),type:"locate",isLocate:!0},this.getCityExt(i.data.cityName)),n.setStorage("ALITRIP_H5_HOME_LOCATE_CITY",e,!0),addHomePerf("locateCityEnd"),addHomePerf("locateCityName",e.cityName),addHomePerf("locateCityStatus","success"),PerfTracker.timelineEnd("\u5b9a\u4f4d\u57ce\u5e02","success",{app:n.getApp(),useMTop:i.data.useMTop||!1}),this.checkLocateCity(o,e)},a),i.on("cityFailure",function(t){addHomePerf("locateCityEnd"),addHomePerf("locateCityStatus","failure"),PerfTracker.timelineEnd("\u5b9a\u4f4d\u57ce\u5e02","failure",{app:n.getApp()}),o.resolve(this.getDefCity(r||null))},a),i.getCity()},200),o.promise)},getCityCode:function(e){var i="";return e&&t.each(a,function(s){return t.each(s.data,function(t){return t.cityName===e?(i=t.code,!1):void 0}),i?!1:void 0}),i},getCityExt:function(e){var i,s,n=new RegExp("\\|("+e+")\\|","i");return t.each(r.data,function(e){return t.each(e.provinceCapital,function(t){return(i=t.map.match(n))?(s={capital:t.name,area:e.area},!1):void 0}),s?!1:void 0}),s||{capital:"",area:""}},getCityEllipsis:function(t){return t=t.replace(/\u5e02$/,""),t.length>3?t.substring(0,3)+"...":t||"\u8bf7\u9009\u62e9"},checkLocateCity:function(t,e){var i=this,s=this.currentCity,n=18e5;s&&s.cityName&&"select"!==s.type&&e.cityName&&s.cityName!=e.cityName&&Date.now()-s.time>n?(i.checkCityConfirm=o.confirm("",'\u4eb2\uff0c\u5b9a\u4f4d\u5230\u60a8\u5728"'+e.cityName+'"\uff0c\u662f\u5426\u5207\u6362\uff1f',function(t,s){this.hide(),i.checkCityConfirm=null,s&&i.setCity(e)}),i.checkCityConfirm.show()):t.resolve(e)},setCity:function(e,i){if(self.checkCityConfirm&&self.checkCityConfirm.hide(0),e){var s,r=this.currentCity,a=t.one(".header .locate span"),o=e.cityName=(e.cityName||"").replace(/\u5e02$/,""),h=/[\?\&]cityName=([^\&\#]*)([\&\#]?)/i,c=location.href.match(h);e.cityEllipsis=e.cityEllipsis||this.getCityEllipsis(e.cityName),this.currentCity=e,n.setStorage("ALITRIP_H5_HOME_CACHE_CITY",e,!0),a&&(a.attr("data-city",e.cityName),a.html(e.cityEllipsis)),c&&history.replaceState&&(s=location.href.replace(c[0].replace(/^[\?\&]/,"").replace(/[\&\#]$/,""),"cityName="+o),history.replaceState({cityName:o},"\u963f\u91cc\u65c5\u884c",s)),(i||!r||r.cityName!==e.cityName)&&this.fireCityChange(e,r)}},bindCityChange:function(t,e){var i=this._cityChangeCallbacks||(this._cityChangeCallbacks=[]);i.push({fn:t,context:e||this})},fireCityChange:function(t,e){var i=this._cityChangeCallbacks;i&&i.forEach(function(i){i.fn&&i.fn.call(i.context,t,e)})}}});KISSY.add("h5-home/datas/city_map",function(){var a={data:[{area:"\u534e\u4e1c",provinceCapital:[{name:"\u4e0a\u6d77",map:"|\u4e0a\u6d77|"},{name:"\u676d\u5dde",map:"|\u676d\u5dde|\u6e56\u5dde|\u5609\u5174|\u91d1\u534e|\u4e3d\u6c34|\u5b81\u6ce2|\u8862\u5dde|\u7ecd\u5174|\u53f0\u5dde|\u6e29\u5dde|\u821f\u5c71|\u5343\u5c9b\u6e56|"},{name:"\u5357\u4eac",map:"|\u5357\u4eac|\u5e38\u719f|\u5e38\u5dde|\u6dee\u5b89|\u8fde\u4e91\u6e2f|\u5357\u901a|\u82cf\u5dde|\u6cf0\u5dde|\u65e0\u9521|\u5f90\u5dde|\u76d0\u57ce|\u626c\u5dde|\u9547\u6c5f|\u5bbf\u8fc1|"},{name:"\u5408\u80a5",map:"|\u5408\u80a5|\u5b89\u5e86|\u868c\u57e0|\u4eb3\u5dde|\u5de2\u6e56|\u6c60\u5dde|\u6ec1\u5dde|\u961c\u9633|\u6dee\u5317|\u6dee\u5357|\u9ec4\u5c71|\u516d\u5b89|\u9a6c\u978d\u5c71|\u94dc\u9675|\u829c\u6e56|\u5bbf\u5dde|\u5ba3\u57ce|"},{name:"\u798f\u5dde",map:"|\u53a6\u95e8|\u798f\u5dde|\u6b66\u5937\u5c71|\u6cc9\u5dde|\u8386\u7530|\u5b81\u5fb7|\u6f33\u5dde|\u4e09\u660e|\u5357\u5e73|\u9f99\u5ca9\uff08\u6c38\u5b9a\u571f\u697c\uff09|"},{name:"\u6d4e\u5357",map:"|\u6d4e\u5357|\u9752\u5c9b|\u5a01\u6d77|\u70df\u53f0|\u6f4d\u574a|\u6dc4\u535a|\u4e1c\u8425|\u4e34\u6c82|\u5fb7\u5dde|\u65e5\u7167|\u83cf\u6cfd|\u804a\u57ce|\u6ee8\u5dde|\u6cf0\u5b89\uff08\u6cf0\u5c71\uff09|\u67a3\u5e84|\u6d4e\u5b81|\u83b1\u829c|"}]},{area:"\u534e\u5317",provinceCapital:[{name:"\u5317\u4eac",map:"|\u5317\u4eac|"},{name:"\u5929\u6d25",map:"|\u5929\u6d25|"},{name:"\u547c\u548c\u6d69\u7279",map:"|\u547c\u548c\u6d69\u7279|\u5174\u5b89\u76df|\u9521\u6797\u90ed\u52d2\u76df|\u963f\u62c9\u5584\u76df|\u963f\u4f4d\u5584\u76df|\u6ee1\u6d32\u91cc|\u5305\u5934|\u4e4c\u6d77|\u8d64\u5cf0|\u901a\u8fbd|\u9102\u5c14\u591a\u65af|\u547c\u4f26\u8d1d\u5c14|\u5df4\u5f66\u6dd6\u5c14|\u4e4c\u5170\u5bdf\u5e03|\u989d\u5c14\u53e4\u7eb3|\u624e\u5170\u5c6f|"},{name:"\u77f3\u5bb6\u5e84",map:"|\u77f3\u5bb6\u5e84|\u5f20\u5bb6\u53e3|\u627f\u5fb7|\u4fdd\u5b9a|\u5510\u5c71|\u5eca\u574a|\u5317\u6234\u6cb3|\u5357\u6234\u6cb3|\u79e6\u7687\u5c9b|\u6ca7\u5dde|\u90a2\u53f0|\u8861\u6c34|\u90af\u90f8|"},{name:"\u592a\u539f",map:"|\u592a\u539f|\u664b\u4e2d|\u5415\u6881|\u5927\u540c|\u5e73\u9065|\u9633\u6cc9|\u957f\u6cbb|\u664b\u57ce|\u4e34\u6c7e|\u8fd0\u57ce|\u6714\u5dde|\u5ffb\u5dde|"},{name:"\u90d1\u5dde",map:"|\u90d1\u5dde|\u5b89\u9633|\u8bb8\u660c|\u4e09\u95e8\u5ce1|\u5546\u4e18|\u4fe1\u9633|\u5468\u53e3|\u9a7b\u9a6c\u5e97|\u6f2f\u6cb3|\u6d1b\u9633|\u5f00\u5c01|\u65b0\u4e61|\u6fee\u9633|\u5357\u9633|\u6d4e\u6e90|\u9e64\u58c1|\u7126\u4f5c|\u5e73\u9876\u5c71|\u767b\u5c01|"},{name:"\u6c88\u9633",map:"|\u6c88\u9633|\u5927\u8fde|\u846b\u82a6\u5c9b|\u9526\u5dde|\u76d8\u9526|\u8425\u53e3|\u4e39\u4e1c|\u978d\u5c71|\u8fbd\u9633|\u672c\u6eaa|\u629a\u987a|\u94c1\u5cad|\u961c\u65b0|\u671d\u9633|"},{name:"\u957f\u6625",map:"|\u957f\u6625|\u56db\u5e73|\u8fbd\u6e90|\u901a\u5316|\u677e\u539f|\u767d\u57ce|\u56fe\u4eec|\u957f\u6625|\u5409\u6797|\u5ef6\u5409|\u767d\u5c71\uff08\u957f\u767d\u5c71\uff09|\u5ef6\u8fb9|"},{name:"\u54c8\u5c14\u6ee8",map:"|\u54c8\u5c14\u6ee8|\u9e21\u897f|\u9e64\u5c97|\u53cc\u9e2d\u5c71|\u4e03\u53f0\u6cb3|\u7ee5\u5316|\u5927\u5174\u5b89\u5cad|\u54c8\u5c14\u6ee8|\u7261\u4e39\u6c5f|\u5927\u5e86|\u9f50\u9f50\u54c8\u5c14|\u9ed1\u6cb3|\u4f73\u6728\u65af|\u4f0a\u6625|"},{name:"\u897f\u5b89",map:"|\u897f\u5b89|\u5ef6\u5b89|\u94dc\u5ddd|\u5b9d\u9e21|\u54b8\u9633|\u6c49\u4e2d|\u6986\u6797|\u5b89\u5eb7|\u5546\u6d1b|\u6e2d\u5357|\u534e\u5c71|"},{name:"\u94f6\u5ddd",map:"|\u94f6\u5ddd|\u77f3\u5634\u5c71|\u5434\u5fe0|\u56fa\u539f|\u4e2d\u536b|"},{name:"\u5170\u5dde",map:"|\u5170\u5dde|\u5929\u6c34|\u5609\u5cea\u5173|\u91d1\u660c|\u6b66\u5a01|\u5f20\u6396|\u9152\u6cc9|\u5e86\u9633|\u5e73\u51c9|\u767d\u94f6|\u5b9a\u897f|\u9647\u5357|\u6566\u714c|\u4e34\u590f|\u7518\u5357|"},{name:"\u897f\u5b81",map:"|\u897f\u5b81|\u9ec4\u5357|\u679c\u6d1b|\u7389\u6811|\u6d77\u897f|\u6d77\u5357|\u6d77\u4e1c|"},{name:"\u4e4c\u9c81\u6728\u9f50",map:"|\u4e4c\u9c81\u6728\u9f50|\u514b\u5b5c\u52d2\u82cf|\u5df4\u97f3\u90ed\u695e|\u660c\u5409|\u535a\u5c14\u5854\u62c9|\u4f0a\u5229|\u5410\u9c81\u756a|\u514b\u62c9\u739b\u4f9d|\u54c8\u5bc6|\u548c\u7530|\u963f\u514b\u82cf|\u5580\u4ec0|\u5854\u57ce|\u963f\u52d2\u6cf0|"}]},{area:"\u897f\u5357",provinceCapital:[{name:"\u91cd\u5e86",map:"|\u91cd\u5e86|"},{name:"\u6210\u90fd",map:"|\u6210\u90fd|\u5357\u5145|\u5b9c\u5bbe|\u5e7f\u5b89|\u8fbe\u5dde|\u96c5\u5b89|\u5df4\u4e2d|\u8d44\u9633|\u7518\u5b5c\u5dde|\u51c9\u5c71\u5dde|\u4e50\u5c71|\u81ea\u8d21|\u6500\u679d\u82b1|\u6cf8\u5dde|\u5fb7\u9633|\u7ef5\u9633|\u5e7f\u5143|\u9042\u5b81|\u5185\u6c5f|\u7709\u5c71\uff08\u5ce8\u7709\u5c71\uff09|\u963f\u575d\u5dde\uff08\u4e5d\u5be8\u6c9f\uff09|"},{name:"\u6606\u660e",map:"|\u6606\u660e|\u6012\u6c5f|\u6cf8\u6cbd\u6e56|\u4e3d\u6c5f|\u5927\u7406|\u897f\u53cc\u7248\u7eb3|\u666e\u6d31|\u8fea\u5e86\uff08\u9999\u683c\u91cc\u62c9\uff09|\u695a\u96c4|\u66f2\u9756|\u7389\u6eaa|\u4fdd\u5c71|\u662d\u901a|\u4e34\u6ca7|\u6587\u5c71|\u7ea2\u6cb3|"},{name:"\u8d35\u9633",map:"|\u8d35\u9633|\u9ed4\u897f\u5357|\u9ed4\u4e1c\u5357|\u9ed4\u5357|\u8d35\u9633|\u9075\u4e49|\u516d\u76d8\u6c34|\u94dc\u4ec1|\u6bd5\u8282|\u5b89\u987a|"},{name:"\u62c9\u8428",map:"|\u62c9\u8428|\u660c\u90fd|\u5c71\u5357|\u65e5\u5580\u5219|\u90a3\u66f2|\u963f\u91cc|\u6797\u829d|"}]},{area:"\u534e\u5357",provinceCapital:[{name:"\u5e7f\u5dde",map:"|\u5e7f\u5dde|\u6df1\u5733|\u73e0\u6d77|\u4f5b\u5c71|\u4e2d\u5c71|\u6c55\u5934|\u97f6\u5173|\u6c5f\u95e8|\u6e5b\u6c5f|\u8302\u540d|\u8087\u5e86|\u60e0\u5dde|\u6885\u5dde|\u6c55\u5c3e|\u6cb3\u6e90|\u9633\u6c5f|\u6e05\u8fdc|\u6f6e\u5dde|\u63ed\u9633|\u4e91\u6d6e|\u4e1c\u839e|"},{name:"\u6d77\u53e3",map:"|\u4e09\u4e9a|\u4e09\u6c99\u5e02|\u897f\u6c99\u7fa4\u5c9b|\u6d77\u53e3|\u5174\u9686|\u6587\u660c|\u4e94\u6307\u5c71|"},{name:"\u6842\u6797",map:"|\u6842\u6797|\u5357\u5b81|\u5317\u6d77|\u67f3\u5dde|\u68a7\u5dde|\u9632\u57ce\u6e2f|\u94a6\u5dde|\u8d35\u6e2f|\u7389\u6797|\u767e\u8272|\u8d3a\u5dde|\u6cb3\u6c60|\u6765\u5bbe|\u5d07\u5de6|"},{name:"\u6b66\u6c49",map:"|\u6b66\u6c49|\u9ec4\u77f3|\u9102\u5dde|\u5b5d\u611f|\u9ec4\u5188|\u54b8\u5b81|\u968f\u5dde|\u8346\u5dde|\u5b9c\u660c|\u8944\u6a0a|\u5341\u5830|\u8346\u95e8|\u6069\u65bd|\u795e\u519c\u67b6|"},{name:"\u957f\u6c99",map:"|\u957f\u6c99|\u682a\u6d32|\u90b5\u9633|\u5cb3\u9633|\u5e38\u5fb7|\u76ca\u9633|\u90f4\u5dde|\u6c38\u5dde|\u6000\u5316|\u5a04\u5e95|\u5f20\u5bb6\u754c|\u6e58\u6f6d|\u8861\u9633|\u6e58\u897f|"},{name:"\u5357\u660c",map:"|\u5357\u660c|\u65b0\u4f59|\u9e70\u6f6d|\u8d63\u5dde|\u5b9c\u6625|\u629a\u5dde|\u4e5d\u6c5f|\u666f\u5fb7\u9547|\u4e0a\u9976|\u840d\u4e61|\u5409\u5b89|"}]}]};return a});KISSY.add("h5-home/datas/city_data",function(){var i=[{key:"\u5b9a\u4f4d\u57ce\u5e02",data:[{cityName:"\u6b63\u5728\u83b7\u53d6\u60a8\u6240\u5728\u7684\u57ce\u5e02\uff0c\u8bf7\u7a0d\u5019...",isLocation:!0,isLocated:!1}]},{key:"\u70ed\u95e8\u57ce\u5e02",data:[{cityName:"\u5317\u4eac",code:"110100",pinYin:"beijing",py:"bj"},{cityName:"\u4e0a\u6d77",code:"310100",pinYin:"shanghai",py:"sh"},{cityName:"\u5e7f\u5dde",code:"440100",pinYin:"guangzhou",py:"gz"},{cityName:"\u6df1\u5733",code:"440300",pinYin:"shenzhen",py:"sz"},{cityName:"\u676d\u5dde",code:"330100",pinYin:"hangzhou",py:"hz"},{cityName:"\u53a6\u95e8",code:"350200",pinYin:"xiamen",py:"xm"},{cityName:"\u5357\u4eac",code:"320100",pinYin:"nanjing",py:"nj"},{cityName:"\u6210\u90fd",code:"510100",pinYin:"chengdu",py:"cd"},{cityName:"\u6b66\u6c49",code:"420100",pinYin:"wuhan",py:"wh"},{cityName:"\u6c88\u9633",code:"210100",pinYin:"shenyang",py:"sy"}]},{key:"B",data:[{cityName:"\u5317\u4eac",code:"110100",pinYin:"beijing",py:"bj"}]},{key:"C",data:[{cityName:"\u957f\u6625",code:"220100",pinYin:"changchun",py:"cc"},{cityName:"\u91cd\u5e86",code:"500100",pinYin:"chengqing",py:"cq"},{cityName:"\u6210\u90fd",code:"510100",pinYin:"chengdu",py:"cd"},{cityName:"\u957f\u6c99",code:"430100",pinYin:"changsha",py:"cs"}]},{key:"D",data:[{cityName:"\u4e1c\u839e",code:"441900",pinYin:"dongguan",py:"dg"},{cityName:"\u5927\u7406",code:"532900",pinYin:"dali",py:"dl"},{cityName:"\u5927\u8fde",code:"210200",pinYin:"dalian",py:"dl"}]},{key:"F",data:[{cityName:"\u798f\u5dde",code:"350100",pinYin:"fuzhou",py:"fz"}]},{key:"G",data:[{cityName:"\u5e7f\u5dde",code:"440100",pinYin:"guangzhou",py:"gz"},{cityName:"\u8d35\u9633",code:"520100",pinYin:"guiyang",py:"gy"},{cityName:"\u6842\u6797",code:"450300",pinYin:"guilin",py:"gl"}]},{key:"H",data:[{cityName:"\u676d\u5dde",code:"330100",pinYin:"hangzhou",py:"hz"},{cityName:"\u5408\u80a5",code:"340100",pinYin:"hefei",py:"hf"},{cityName:"\u6d77\u53e3",code:"460100",pinYin:"haikou",py:"haikou"},{cityName:"\u547c\u548c\u6d69\u7279",code:"150100",pinYin:"huhehaote",py:"hhht"},{cityName:"\u54c8\u5c14\u6ee8",code:"230100",pinYin:"haerbin",py:"heb"},{cityName:"\u9ec4\u5c71",code:"341000",pinYin:"huangshan",py:"hs"}]},{key:"J",data:[{cityName:"\u6d4e\u5357",code:"370100",pinYin:"jinan",py:"jn"}]},{key:"K",data:[{cityName:"\u6606\u660e",code:"530100",pinYin:"kunming",py:"km"}]},{key:"L",data:[{cityName:"\u4e3d\u6c5f",code:"530700",pinYin:"lijiang",py:"lj"},{cityName:"\u5170\u5dde",code:"620100",pinYin:"lanzhou",py:"lz"},{cityName:"\u62c9\u8428",code:"540100",pinYin:"lasa",py:"ls"}]},{key:"N",data:[{cityName:"\u5b81\u6ce2",code:"330200",pinYin:"ningbo",py:"nb"},{cityName:"\u5357\u4eac",code:"320100",pinYin:"nanjing",py:"nj"},{cityName:"\u5357\u660c",code:"360100",pinYin:"nanchang",py:"nc"},{cityName:"\u5357\u5b81",code:"450100",pinYin:"nanning",py:"nn"}]},{key:"Q",data:[{cityName:"\u9752\u5c9b",code:"370200",pinYin:"qingdao",py:"qd"}]},{key:"S",data:[{cityName:"\u4e0a\u6d77",code:"310100",pinYin:"shanghai",py:"sh"},{cityName:"\u82cf\u5dde",code:"320500",pinYin:"suzhou",py:"sz"},{cityName:"\u6df1\u5733",code:"440300",pinYin:"shenzhen",py:"sz"},{cityName:"\u4e09\u4e9a",code:"460200",pinYin:"sanya",py:"sy"},{cityName:"\u77f3\u5bb6\u5e84",code:"130100",pinYin:"shijiazhuang",py:"sjz"},{cityName:"\u6c88\u9633",code:"210100",pinYin:"shenyang",py:"sy"}]},{key:"T",data:[{cityName:"\u5929\u6d25",code:"120100",pinYin:"tianjing",py:"tj"},{cityName:"\u592a\u539f",code:"140100",pinYin:"taiyuan",py:"ty"}]},{key:"W",data:[{cityName:"\u6e29\u5dde",code:"330300",pinYin:"wenzhou",py:"wz"},{cityName:"\u65e0\u9521",code:"320200",pinYin:"wuxi",py:"wx"},{cityName:"\u6b66\u6c49",code:"420100",pinYin:"wuhan",py:"wh"},{cityName:"\u4e4c\u9c81\u6728\u9f50",code:"650100",pinYin:"wulumuqi",py:"wlmq"}]},{key:"X",data:[{cityName:"\u53a6\u95e8",code:"350200",pinYin:"xiamen",py:"xm"},{cityName:"\u897f\u5b81",code:"630100",pinYin:"xining",py:"xn"},{cityName:"\u897f\u5b89",code:"610100",pinYin:"xian",py:"xa"}]},{key:"Y",data:[{cityName:"\u94f6\u5ddd",code:"640100",pinYin:"yinchuan",py:"yc"}]},{key:"Z",data:[{cityName:"\u73e0\u6d77",code:"440400",pinYin:"zhuhai",py:"zh"},{cityName:"\u90d1\u5dde",code:"410100",pinYin:"zhengzhou",py:"zz"}]}];return i});KISSY.add("h5-home/widgets/notification/index",function(t){~function(){KISSY.ready(function(){var t=document.createElement("style");t.type="text/css",t.innerHTML=".c-float-modePop{text-align:center}.c-float-modePop .warnMsg{color:#fff}.c-float-modePop button{padding:6px 9px 6px 9px;color:#157afb;background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#404040),color-stop(100%,#2e2e2e));border:0}.c-float-shade{width:100%;display:block;position:absolute;z-index:99;background-color:#000;opacity:.5;top:0;left:0}.c-float-mask{position:fixed;top:0;left:0;bottom:0;right:0;height:100%;width:100%;z-index:9998;background:rgba(0,0,0,0.7);opacity:0;-webkit-transition:opacity .3s linear 0s}.c-float-shade.hide{display:none}.c-float-mask.hide{display:none}.c-float-popWrap{width:270px;border-radius:8px;-webkit-border-radius:8px;z-index:9999;position:fixed;overflow:hidden;left:50%;top:50%;margin-left:-135px;-webkit-transition:opacity .3s linear 0s}.c-float-popWrap .c-float-modePop{background-color:rgba(0,0,0,0.7);-webkit-border-radius:8px;border-radius:8px;overflow:hidden;padding:15px 20px}.c-float-popWrap .c-float-modePop .warnMsg{padding:0;font-size:15px;line-height:22px;color:#fff;font-weight:normal}.c-float-popWrap .c-float-modePop .content{line-height:1.5}.c-float-popWrap.hide{display:none;-webkit-box-shadow:none}.c-float-popWrap.show{display:block}.c-float-popWrap.msgMode .c-float-modePop .content,.c-float-popWrap.msgMode .c-float-modePop .doBtn{display:none}.c-float-popWrap.alertMode .c-float-modePop .content{display:none}.c-float-popWrap.alertMode .c-float-modePop .doBtn .cancel{display:none}.c-float-popWrap.alertMode,.c-float-popWrap.confirmMode{width:270px}.c-float-popWrap.alertMode .c-float-modePop,.c-float-popWrap.confirmMode .c-float-modePop{background:#fff;padding:0;color:#202325}.c-float-popWrap.alertMode .c-float-modePop .content,.c-float-popWrap.confirmMode .c-float-modePop .content{padding:15px 20px;border-bottom:1px solid #d6d9dc}.c-float-popWrap.alertMode .c-float-modePop .warnMsg,.c-float-popWrap.confirmMode .c-float-modePop .warnMsg{padding:12px 20px;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;text-align:center;font-weight:bold}.c-float-popWrap.alertMode .c-float-modePop .warnMsg,.c-float-popWrap.alertMode .c-float-modePop .doBtn,.c-float-popWrap.confirmMode .c-float-modePop .warnMsg,.c-float-popWrap.confirmMode .c-float-modePop .doBtn{border-bottom:1px solid #d6d9dc;color:#202325}.c-float-popWrap.alertMode .c-float-modePop .doBtn,.c-float-popWrap.confirmMode .c-float-modePop .doBtn{border-bottom:0;display:-webkit-box;-webkit-box-align:center}.c-float-popWrap.alertMode .c-float-modePop .content,.c-float-popWrap.confirmMode .c-float-modePop .content{display:block;color:#202325;padding:15px 20px;line-height:24px;font-size:15px;text-align:left;font-weight:bold}.c-float-modePop button{-webkit-box-flex:1;color:#157afb;background:#fff;height:48px;font-size:18px;display:block}.c-float-modePop button.cancel{border-right:1px solid #b2b2b2}.c-float-modePop button.ok{font-weight:bold}",document.head.appendChild(t)})}();return function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){this.callback&&this.callback(t,!0)}function s(t){this.callback&&this.callback(t,!1)}function n(t){this._options=e({mode:"msg",text:"\u7f51\u9875\u63d0\u793a",useTap:!1},t||{}),this._init()}var r,o,a,c,h,l,u,d,p,f=t.document,g=(f.body,!1);p=f.createElement("div"),p.className="c-float-mask hide",r=f.createElement("div"),r.className="c-float-popWrap msgMode hide",r.innerHTML=['<div class="c-float-modePop">','<div class="warnMsg"></div>','<div class="content"></div>','<div class="doBtn">','<button class="cancel">\u53d6\u6d88</button>','<button class="ok">\u786e\u5b9a</button>',"</div>","</div>"].join(""),o=r.querySelector(".warnMsg"),a=r.querySelector(".content"),c=r.querySelector(".doBtn .ok"),h=r.querySelector(".doBtn .cancel"),o.addEventListener("click",function(){},!1),e(n.prototype,{_init:function(){var e=this,n=e._options,l=n.mode,u=n.text,d=n.okText,m=n.cancelText,y=n.content,v=n.callback,b=n.background,_=n.useTap?"touchend":"click",w=r.className;w=w.replace(/(msg|alert|confirm)Mode/i,l+"Mode"),r.className=w,b&&(r.style.background=b),u?(o.innerHTML=u,o.style.display="block"):o.style.display="none",y?(a.innerHTML=y,a.style.display="block"):a.style.display="none",c.innerHTML=d||"\u786e\u5b9a",h.innerHTML=m||"\u53d6\u6d88","alert"==l||"confirm"==l?this.hasMask=!0:this.hasMask=!1,c.removeEventListener("touchend",i),c.removeEventListener("click",i),h.removeEventListener("touchend",i),h.removeEventListener("click",i),c.addEventListener(_,i,!1),h.addEventListener(_,s,!1),c.callback=h.callback=function(){v.apply(e,arguments)},g||(g=!0,f.body.appendChild(p),f.body.appendChild(r),t.addEventListener("resize",function(){setTimeout(function(){e._pos()},500)},!1))},_pos:function(){var t=r.getBoundingClientRect(),e=t.width,i=t.height;r.style.marginLeft=-e/2+"px",r.style.marginTop=-i/2+"px"},isShow:function(){return r.className.indexOf("show")>-1},isHide:function(){return r.className.indexOf("hide")>-1},_cbShow:function(t){var e=this,i=e._options,s=i.onShow;r.style.opacity="1",e.hasMask&&(p.style.opacity="1"),e.hasMask&&(p.className=p.className.replace(/hide/g,"").trim()),e.isShow()||(r.className+=" show",e.hasMask&&(p.className+=" show")),t&&e._pos(),s&&s.call(e)},show:function(){var t=this;l&&(clearTimeout(l),l=null,this._cbHide()),u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),t.isShow()?t._cbShow(!0):(r.className=r.className.replace(/hide/g,"").trim(),t.hasMask&&(p.className=p.className.replace(/hide/g,"").trim()),t._pos(),setTimeout(function(){r.style.opacity="1",t.hasMask&&(p.style.opacity="1")},1),u=setTimeout(function(){t._cbShow()},300))},_cbHide:function(){var t=this,e=t._options,i=e.onHide;r.style.opacity="0",p.style.opacity="0",t.isHide()||(r.className=r.className.replace(/hide|show/g,"").trim(),r.className+=" hide",p.className=p.className.replace(/hide|show/g,"").trim(),p.className+=" hide"),i&&i.call(t)},hide:function(t){var e=this;u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),e.isHide()?e._cbHide():(r.className=r.className.replace(/show/g,"").trim(),p.className=p.className.replace(/show/g,"").trim(),setTimeout(function(){r.style.opacity="0",p.style.opacity="0"},1),d=setTimeout(function(){e._cbHide()},t||300))},flash:function(t){var e=this;e._options;e.show(),l=setTimeout(function(){l&&e.hide()},t)}});var m=new function(){this.simple=function(t,e,i){2==arguments.length&&"number"==typeof arguments[1]&&(i=arguments[1],e=void 0);var s=new n({mode:"msg",text:t,background:e});return s.flash(i||2e3),s},this.msg=function(t,i){return new n(e({mode:"msg",text:t},i||{}))},this.alert=function(t,i,s,r){return"function"==typeof i&&(r=s,s=i,i=null),new n(e({mode:"alert",text:t,content:i,callback:s},r||{}))},this.confirm=function(t,i,s,r){return new n(e({mode:"confirm",text:t,content:i,callback:s},r||{}))},this.pop=function(t){return new n(t)}};return m}(window)},{requires:[]});KISSY.add("h5-home/widgets/geolocation/city",function(t,e,i){var n=e.extend({initializer:function(){this.cityLocating=!1,this.clearCity(),this.publish("citySuccess"),this.publish("cityFailure")},getCity:function(t,e,i){var n=this;return this.cityLocating=!0,t?this._getCity(t,e,i):this.geolocation(function(t){t.city&&/AliTrip/i.test(navigator.userAgent)&&(t.cityName=t.city),t.address&&(t.cityName=t.address.city,t.cityCode=t.address.cityCode),!t.cityName||!t.cityCode&&n.get("needCityCode")?this._getCity(t.coords,e,i):(t.msg="\u8c03\u7528\u6210\u529f",t.latitude=t.latitude||t.coords.latitude,t.longitude=t.longitude||t.coords.longitude,n.cityLocating=!1,n.citySuccessData=t,n.citySucceed=!0,n.fire("citySuccess",{data:t}),e&&e.call(n,t))},function(t){this.cityLocating=!1,this.cityFailureData=t,this.citySucceed=!1,this.fire("cityFailure",{data:t}),i&&i.call(n,t)}),this},clearCity:function(){return this.clear(),this.citySuccessData=null,this.cityFailureData=null,this.citySucceed=!1,this},_getCity:function(t,e,n){var s=this;i.getApi("Mtop.trip.common.getCityCodeByLatitudeAndLongitude","1.0",{latitude:t.latitude,longitude:t.longitude},{},function(i){var o=i.data;o.msg=i.ret[0].split("::")[1],o.latitude=o.latitude||t.latitude,o.longitude=o.longitude||t.longitude,o.useMTop=!0,s.cityLocating=!1,i.ret[0].indexOf("SUCCESS::")>-1&&"900000"!==o.cityCode&&"[]"!==o.cityName?(s.citySuccessData=o,s.citySucceed=!0,s.fire("citySuccess",{data:o}),e&&e.call(s,o)):(s.cityFailureData=i,s.citySucceed=!1,s.fire("cityFailure",{data:i}),n&&n.call(s,i))},function(t){s.cityLocating=!1,s.cityFailureData=t,s.citySucceed=!1,s.fire("cityFailure",{data:t}),n&&n.call(s,t)})}});return n},{requires:["./index","mtop"]});KISSY.add("h5-home/widgets/geolocation/index",function(S,Base,Bridge){var windVaneURL="//g.alicdn.com/mtb/lib-windvane/2.1.1/windvane.js",isWindVane=/WindVane/i.test(window.navigator.userAgent),isInAlipayNewClient=function(){var t=navigator.userAgent.match(/AlipayClient[\s\/][\d\.]+/gim),e=t?parseInt(t[0].match(/[\d\.]+/gim)[0].split(".").join("")):0;return e=parseInt(e.toString().substr(0,3)),e>=810?!0:!1}(),isAliTrip=navigator.userAgent.match(/AliTrip[\s\/][\d\.]+/gim),AliTripBridge=Bridge.Global,ALIPAY_ERRCODE={11:1,12:2,13:2,14:3},ATTRS={timeout:{value:12e3},PERMISSION_DENIED:{value:'\u4eb2\uff0c\u8981\u5f00\u542f\u7f51\u7edc\u5b9a\u4f4d\u624d\u80fd\u67e5\u770b\u54e6\uff01\u8bf7\u5728"\u8bbe\u7f6e"-"\u4f4d\u7f6e\u548c\u5b89\u5168"-\u52fe\u9009"\u4f7f\u7528\u65e0\u7ebf\u7f51\u7edc"\uff01'},POSITION_UNAVAILABLE:{value:"\u5b9a\u4f4d\u5931\u8d25"},TIMEOUT_MSG:{value:"\u4eb2\uff0c\u4f4d\u7f6e\u4fe1\u606f\u83b7\u53d6\u8d85\u65f6\uff0c\u7a0d\u540e\u518d\u8bd5\u5427\uff01"},UNKNOW_ERROR:{value:"\u672a\u77e5\u9519\u8bef\u3002"},NO_SUPPORT:{value:"\u4eb2\uff0c\u60a8\u7684\u8bbe\u5907\u4e0d\u652f\u6301\u5b9a\u4f4d\u529f\u80fd\uff01"}},GeoLocation=Base.extend({initializer:function(){this.locating=!0,this.requests={},this.clear(),this.publish("success"),this.publish("failure")},successFire:function(t,e){clearTimeout(this.timer),this.locating=!1,this.succeed=!0,this.successData=t,this.fire("success",{data:t}),e&&e.call(this,t)},errorFire:function(t,e,i){clearTimeout(this.timer);var s={msg:t,status:e};this.locating=!1,this.succeed=!1,this.failureData=s,this.fire("failure",{data:s}),i&&i.call(this,s)},clear:function(){return this.successData=null,this.failureData=null,this.succeed=!1,this},geolocation:function(succ,err){function success(position){if(isAliTrip){try{position="object"==typeof position?position:JSON.parse(position)}catch(err){position=eval("("+position+")")}position.coords={latitude:position.latitude,longitude:position.longtitude}}isInAlipayNewClient&&(position.coords={latitude:position.latitude,longitude:position.longitude}),self.requests[tag]&&self.successFire(position,succ),delete self.requests[tag]}function error(message){if(message&&"object"==typeof message){if(isAliTrip){try{message="object"==typeof message?message:JSON.parse(message)}catch(err){message=eval("("+message+")")}message.code=message.error_code,message.message=message.error_msg,message.domain=message.error_domain}switch(isInAlipayNewClient&&(message.code=message.error?ALIPAY_ERRCODE[message.error]||"":"",message.message=message.message||message.errorMessage),message.PERMISSION_DENIED||(message.PERMISSION_DENIED=1),message.POSITION_UNAVAILABLE||(message.POSITION_UNAVAILABLE=2),message.TIMEOUT||(message.TIMEOUT=3),message.code){case message.PERMISSION_DENIED:self.errorFire(self.get("PERMISSION_DENIED"),"PERMISSION_DENIED",err);break;case message.POSITION_UNAVAILABLE:self.errorFire(self.get("POSITION_UNAVAILABLE"),"POSITION_UNAVAILABLE",err);break;case message.TIMEOUT:self.errorFire(self.get("TIMEOUT_MSG"),"TIMEOUT_MSG",err);break;default:self.errorFire(self.get("UNKNOW_ERROR"),"UNKNOW_ERROR",err)}self.requests[tag]&&delete self.requests[tag],delete self.requests[tag]}}function startTimeout(){clearTimeout(self.timer),self.timer=setTimeout(function(){clearTimeout(self.timer),self.requests[tag]&&(delete self.requests[tag],self.errorFire(self.get("TIMEOUT_MSG"),"TIMEOUT_MSG",err))},self.get("timeout"))}var self=this,tag=(new Date).getTime()+"";if(self.requests[tag]=!0,self.locating=!0,isWindVane){var windvaneLocFn=function(){window.WindVane.call("WVLocation","getLocation",{enableHighAcuracy:!0,address:!0},success,error),startTimeout()};return void(window.WindVane&&window.WindVane.call?windvaneLocFn():S.getScript(windVaneURL,{success:windvaneLocFn,error:function(){self.errorFire(self.get("NO_SUPPORT"),"NO_SUPPORT",err)}}))}if(isAliTrip)return AliTripBridge.pushBack("native:","lbs/locate",{successCallback:success,failCallback:error}),void startTimeout();if(isInAlipayNewClient){var readyCallback=function(){AlipayJSBridge.call("getLocation",function(t){return t.error?void error(t):void success(t)}),document.removeEventListener("AlipayJSBridgeReady",readyCallback,!1),startTimeout()};return void(window.AlipayJSBridge&&AlipayJSBridge.call?readyCallback():document.addEventListener("AlipayJSBridgeReady",readyCallback,!1))}navigator.geolocation?(navigator.geolocation.getCurrentPosition(success,error,{timeout:self.get("timeout"),enableHighAccuracy:!0}),startTimeout()):self.errorFire(self.get("NO_SUPPORT"),"NO_SUPPORT",err)}},{ATTRS:ATTRS});return GeoLocation},{requires:["base","bridge"]});KISSY.add("h5-home/pages/home/data",function(t,require,e,i){"use strict";var s=require("q"),n=(require("io"),require("ua"),require("mtop")),a=require("./util"),r={id:"trip_home_titlebar",useOfflineData:!0,items:[{label:"\u76ee\u7684\u5730/\u666f\u70b9/\u9152\u5e97/\u95e8\u7968",href:"http://h5.m.taobao.com/trip/home/search/index.html"}]},o={id:"trip_home_banner",useOfflineData:!0,items:[]},c=window.isInAlipay?{id:"trip_home_entry",useOfflineData:!0,items:[{title:"\u673a\u7968",href_h5:"//h5.m.taobao.com/trip/flight/search/index.html",trackname:"flight"},{title:"\u9152\u5e97\u5ba2\u6808",href_h5:"//h5.m.taobao.com/trip/hotel/search/index.html",trackname:"hotel"},{title:"\u706b\u8f66\u7968",href_h5:"//h5.m.taobao.com/trip/train/search/index.html",trackname:"train"},{title:"\u95e8\u7968",href_h5:"//h5.m.taobao.com/trip/ticket/search/index.html",trackname:"ticket"},{title:"\u9886\u91cc\u7a0b",href_h5:"//h5.m.taobao.com/trip/member/member-center/index.html",refreshType:"1",trackname:"member"}]}:{id:"trip_home_entry",useOfflineData:!0,items:[{title:"\u673a\u7968",href_h5:"//h5.m.taobao.com/trip/flight/search/index.html",trackname:"flight"},{title:"\u9152\u5e97\u5ba2\u6808",href_h5:"//h5.m.taobao.com/trip/hotel/search/index.html",trackname:"hotel"},{title:"\u65c5\u6e38\u5ea6\u5047",href_h5:"//h5.m.taobao.com/trip/holiday/tourlist/index.html",trackname:"vacation"},{title:"\u7b7e\u8bc1",href_h5:"//h5.m.taobao.com/trip/visa/search/index.html",trackname:"visa"},{title:"\u95e8\u7968",href_h5:"//h5.m.taobao.com/trip/ticket/search/index.html",trackname:"ticket"},{title:"\u706b\u8f66\u7968",href_h5:"//h5.m.taobao.com/trip/train/search/index.html",trackname:"train"},{title:"\u6c7d\u8f66\u7968",href_h5:"//h5.m.taobao.com/trip/car/search/index.html",trackname:"bus"},{title:"\u7528\u8f66",href_h5:"//h5.m.taobao.com/trip/taxi/home/index.html",trackname:"car"},{title:"Wifi\u7535\u8bdd\u5361",href_h5:"//h5.m.taobao.com/trip/holiday-category/wifi/index.html",trackname:"wifi"},{title:"\u9886\u91cc\u7a0b",href_h5:"//h5.m.taobao.com/trip/member/member-center/index.html",refreshType:"1",trackname:"member"}]},h={id:"trip_home_channel1",items:[{href:"https://h5.m.taobao.com/trip/onsale/index/index.html?trip_rn=onsale_onsale",title:"\u53bb\u62a2\u8d2d",trackname:"Sale"},{href:"https://quamarket.m.taobao.com/markets/h5/hotel-favorable",image:"https://gw.alicdn.com/tps/TB1pMcMLpXXXXarXpXXXXXXXXXX-640-368.png",subTitle:"\u8d85\u4f4e\u6298\u6263\u75af\u62a2",title:"\u7279\u60e0\u9152\u5e97",trackname:"HotelSale"}]},l={id:"trip_home_channel2",items:[{href:"https://h5.m.taobao.com/trip/flight/onsale/index.html",image:"https://gw.alicdn.com/tps/TB1dPQqLpXXXXa_aXXXXXXXXXXX-640-368.png",title:"\u7279\u4ef7\u673a\u7968",subTitle:"\u60f3\u4e0d\u5230\u7684\u4f4e\u4ef7",trackname:"FlightSale"},{href:"https://h5.m.taobao.com/trip/member/member-center/index.html#coupons",image:"https://gw.alicdn.com/tps/TB1pMcMLpXXXXarXpXXXXXXXXXX-640-368.png",title:"\u4f1a\u5458\u4e13\u4eab",h5SubTitle:"\u91cc\u7a0b\u6362\u7ea2\u5305",trackname:"MemberSale"}]},u={id:"trip_home_channel3",items:[{href:"https://quamarket.m.taobao.com/markets/h5/tripticket",image:"https://gw.alicdn.com/tps/TB1bxsHLpXXXXaIXFXXXXXXXXXX-1280-252.png",title:"\u8d85\u7ea7\u9884\u552e",subTitle:"\u5929\u5929\u62a2\u60ca\u559c\u4ef7",trackname:"PreSale"}]},d=[{id:"trip_home_subcategory_hotel_title_bar",items:[{title:"\u9152\u5e97\u4f4f\u5bbf",trackname:"subcategory-hotel"}]},{id:"trip_home_subcategory_hotel_items",items:[{href_h5:"https://quamarket.m.taobao.com/markets/h5/hotel-favorable",title:"\u9152\u5e97\u7279\u60e0",trackname:"hotel-jdth"},{href_h5:"https://quamarket.m.taobao.com/markets/h5/meishijiem_pindao",title:"\u7f8e\u98df",trackname:"hotel-ms"}]},{id:"trip_home_subcategory_traffic_title_bar",items:[{title:"\u4ea4\u901a\u51fa\u884c",trackname:"subcategory-traffic"}]},{id:"trip_home_subcategory_traffic_items",items:[{href_h5:"https://h5.m.taobao.com/trip/flight/onsale/index.html",title:"\u7279\u4ef7\u673a\u7968",trackname:"traffic-tjjp"},{href_h5:"https://h5.m.taobao.com/trip/car/search/index.html",title:"\u6c7d\u8f66\u7968",trackname:"traffic-qcp"},{href_h5:"https://h5.m.taobao.com/trip/charter-car/airport/index.html",title:"\u63a5\u9001\u673a",trackname:"traffic-jsj"}]},{id:"trip_home_subcategory_vacation_title_bar",items:[{title:"\u65c5\u6e38\u5ea6\u5047",trackname:"subcategory-vacation"}]},{id:"trip_home_subcategory_vacation_items",items:[{href_h5:"https://h5.m.taobao.com/trip/holiday/surrounding/index.html",title:"\u5468\u8fb9\u6e38",trackname:"vacation-zby"},{href_h5:"https://h5.m.taobao.com/trip/holiday/tourlist/index.html?tourtype=guonei",title:"\u56fd\u5185\u6e38",trackname:"vacation-gny"},{href_h5:"https://quamarket.m.taobao.com/markets/h5/chujing_mddzhuantiye",title:"\u5883\u5916\u6e38",trackname:"vacation-jwy"},{href_h5:"https://h5.m.taobao.com/trip/visa/search/index.html",title:"\u7b7e\u8bc1",trackname:"vacation-qz"},{href_h5:"https://h5.m.taobao.com/trip/holiday-category/wifi/index.html",title:"Wifi\u7535\u8bdd\u5361",trackname:"vacation-wifi"},{href_h5:"https://h5.m.taobao.com/trip/holiday-category/ship/index.html",title:"\u90ae\u8f6e",trackname:"vacation-yl"},{href_h5:"https://h5.m.taobao.com/trip/hk/index/index.html",title:"\u73af\u7403\u8d2d\u7269",trackname:"vacation-hqgw"},{href_h5:"https://h5.m.taobao.com/trip/holiday-category/rentcar/index.html?qtype=zijia",title:"\u81ea\u9a7e\u79df\u8f66",trackname:"vacation-zjzc"},{href_h5:"https://h5.m.taobao.com/trip/holiday-category/rentcar/index.html?qtype=baoche",title:"\u65c5\u6e38\u5305\u8f66",trackname:"vacation-lybc"}]},{id:"trip_home_section_divider",items:[]}];i.exports={dataMap:{},requestId:0,fetch:function(t){var e=this,i=s.defer(),n=++this.requestId;Date.now();return addHomePerf("fetchStart"),PerfTracker.timelineStart("\u83b7\u53d6\u9875\u9762\u6570\u636e_"+n),this.fetchLayout(t,n).then(function(t){PerfTracker.timelineEnd("\u83b7\u53d6\u9875\u9762\u6570\u636e_"+n),n===e.requestId&&(addHomePerf("fetchEnd"),e.data=e.parseData(t),i.resolve(e.data))},function(){PerfTracker.timelineEnd("\u83b7\u53d6\u9875\u9762\u6570\u636e_"+n,"failure"),n===e.requestId&&i.reject("\u83b7\u53d6\u9875\u9762\u6570\u636e\u5931\u8d25")}),i.promise},fetchLayout:function(t,e){var i=this,a=s.defer(),r=navigator.userAgent.match(/alitrip/i)?"2510":"709";return addHomePerf("fetchLayoutStart"),PerfTracker.timelineStart("\u83b7\u53d6\u9875\u9762\u5e03\u5c40\u6570\u636e_"+e),n.getApi("mtop.trip.uilayout.queryUILayout","1.0",{uiLayoutName:window.isInAlipay?"qua_home_alipay":"qua_home",uiLayoutVersion:"2.0",clientPlatform:"h5",userCity:t.cityName,userCityType:"0",userCityCode:t.cityCode||"",userLng:t.longitude||"",userLat:t.latitude||"",extraParams:JSON.stringify({provinceCityName:t.capital||"",checkInChannel:r})},{},function(t){if(PerfTracker.timelineEnd("\u83b7\u53d6\u9875\u9762\u5e03\u5c40\u6570\u636e_"+e),t&&t.data&&t.data.sections&&t.data.sections.length){if(addHomePerf("fetchLayoutEnd"),addHomePerf("fetchLayoutStatus","success"),e!==i.requestId)return;a.resolve(t.data)}else{if(addHomePerf("fetchLayoutEnd"),addHomePerf("fetchLayoutStatus","failure"),e!==i.requestId)return;a.reject(t)}},function(t){PerfTracker.timelineEnd("\u83b7\u53d6\u9875\u9762\u5e03\u5c40\u6570\u636e_"+e,"failure"),addHomePerf("fetchLayoutEnd"),addHomePerf("fetchLayoutStatus","failure"),e===i.requestId&&a.reject(t)}),a.promise},fetchCrossSale:function(t){var e=this,i=s.defer(),a=this.requestId;return addHomePerf("fetchCrossStart"),PerfTracker.timelineStart("\u83b7\u53d6\u4ea4\u53c9\u8425\u9500\u6570\u636e_"+a),n.getApi("mtop.trip.activity.queryTMSResources","1.0",{clientPlatform:"h5",resourceHolderNames:JSON.stringify(["cross_sale_home_page"]),extraParams:JSON.stringify({userLocalCity:t.cityName})},{},function(t){if(PerfTracker.timelineEnd("\u83b7\u53d6\u4ea4\u53c9\u8425\u9500\u6570\u636e_"+a),t&&t.data&&t.data.cross_sale_home_page&&t.data.cross_sale_home_page.banner&&t.data.cross_sale_home_page.banner.length){if(addHomePerf("fetchCrossEnd"),addHomePerf("fetchCrossStatus","success"),a!==e.requestId)return;e.crossSaleData=e.parseCrossSaleData(e.getSectionData(e.data,"trip_home_banner"),t.data.cross_sale_home_page.banner),i.resolve(e.crossSaleData)}else{if(addHomePerf("fetchCrossEnd"),addHomePerf("fetchCrossStatus","failure"),a!==e.requestId)return;i.reject(t)}},function(t){PerfTracker.timelineEnd("\u83b7\u53d6\u4ea4\u53c9\u8425\u9500\u6570\u636e_"+a,"failure"),addHomePerf("fetchCrossEnd"),addHomePerf("fetchCrossStatus","failure"),a===e.requestId&&i.reject(t)}),i.promise},passCrossDataBack:function(e){var i=null;try{i=JSON.parse(e)}catch(s){}i&&(t.each(i,function(t,e){i[e]=JSON.stringify(t)}),i=t.merge({clientPlatform:"h5"},i),n.getApi("mtop.trip.resourceholder.callback","1.0",i,{},function(t){console.log("cross callback success")},function(){console.log("cross callback failure")}))},parseData:function(t){var e=this,i=!1,s=!1,n=!1,p=!1,f=!1,m=!1,g=!1;if(this.dataMap={},a.setStorage("ALITRIP_H5_HOME_AROUND_SCENIC",""),a.setStorage("ALITRIP_H5_HOME_FAVOR_CONTENTS",""),t.sections&&t.sections.length&&(location.host.match(/dev/)&&t.sections[t.sections.length-1].id.match(/favor/i)&&(t.sections.pop(),t.sections.pop()),t.sections.forEach(function(t){switch(t.isInAlipay=window.isInAlipay,e.dataMap[t.id]=t,t.id){case"trip_home_titlebar":i=!0;break;case"trip_home_banner":s=!0;break;case"trip_home_entry":n=!0;break;case"trip_home_channel1":p=!0;break;case"trip_home_channel2":f=!0;break;case"trip_home_channel3":m=!0;break;default:/trip_home_subcategory_[a-zA-Z]+_title_bar/i.test(t.id)?g=!0:/trip_home_subcategory_[a-zA-Z]+_items/i.test(t.id)&&(g=!0)}}),!i&&t.sections.splice(0,0,e.dataMap.trip_home_titlebar=r),!s&&t.sections.splice(1,0,e.dataMap.trip_home_banner=o),!n&&t.sections.splice(2,0,e.dataMap.trip_home_entry=c),!p&&t.sections.splice(3,0,e.dataMap.trip_home_channel1=h),!f&&t.sections.splice(4,0,e.dataMap.trip_home_channel2=l),!m&&t.sections.splice(5,0,e.dataMap.trip_home_channel3=u),window.isInAlipay&&!g)){var y=3;d.forEach(function(i){e.dataMap[i.id]=i,t.sections.splice(y++,0,i)})}return t.serverYear={id:"trip_home_footer",year:new Date(t.serverTime||Date.now()).getFullYear()},t.tabbar={id:"trip_home_h5_tabbar",href:"//h5."+(location.host.match("waptest|wapa")||["m"])[0]+".taobao.com/trip/journey/schedule/index.html?fromHome=true"},console.log(t),t},parseCrossSaleData:function(t,e){if(t&&t.items&&t.items.length&&e&&e.length){var i,s=t.items,n=!1,a=!1;if(e.forEach(function(t){if(n)return!1;if(t.isCross=!0,t.href||t.href_h5){if(1==t.onlyMe)return t.screenNum=1,s.length=0,s.push(t),a=n=!0,!1;i=Number(t.screenNum)||1,i>s.length?s.push(t):s.splice(i-1,0,t),a=!0}}),a)return{sections:[t],id:t.id}}},getSectionData:function(t,e){if(t.sections&&t.sections.length)for(var i=0,s=t.sections.length;s>i;i++)if(t.sections[i]&&t.sections[i].id===e)return t.sections[i];return null}}});KISSY.add("h5-home/pages/home/view",function(t,require,e,i){"use strict";var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},s=t.one(document.documentElement),r=require("ua"),a=require("juicer"),o=(require("jsbridge"),require("./util")),c=require("./offline"),h=require("../../widgets/lazyload/lite"),l=[require("./mods/banner/"),require("./mods/headline/"),require("./mods/onsale/"),require("./mods/favor/")],d={};l.forEach(function(t){d[t.id]=t}),window.isInAlipay&&l.pop();(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}})();i.exports={container:t.one(".container-home"),renderCount:0,render:function(t){var e=this.renderHTML(t),i=d.trip_home_banner;this.renderCount++,this.renderMods(e),this.renderLazyload(),this.rendered=!0,t&&i&&i.rendered&&!i.destroyed&&i.slide&&(i.slide.stop(),i.slide.scrollTo(1,0),i.slide.play()),addHomePerf("render"+this.renderCount),2==this.renderCount?(this.renderGoToTop(),n(function(){HomeFireEvent("afterhomerendered",{Home:this})})):this.renderCount>2&&window.scrollTo(0,0),(window.ALITRIP_HOME_USE_CACHE_HTML?1==this.renderCount:2==this.renderCount)&&PerfTracker.interactCompleted()},renderCrossSale:function(e){if(e){var i=t.one("."+e.id),n=this._getTpls(e,e.id),s=n?a(n.tpl,e):"";s&&(this.destroyMods(e.sections),i&&i.replaceWith(s),this.renderMods(e.sections),this.lazyload.update())}},renderHTML:function(e){if(!e)return l;var i,n,e=this.data,s=this.currentCity,r=this.container,c=this._getTpls(e),h=o.getStorage("ALITRIP_H5_HOME_CACHE_APP"),d=o.getStorage("ALITRIP_H5_HOME_CACHE_TPLS",!0),u=o.getStorage("ALITRIP_H5_HOME_CACHE_VERSION"),p=Number(o.getStorage("ALITRIP_H5_HOME_CACHE_EXPIRE")||0),f=window.ALITRIP_HOME_USE_CACHE_HTML,m=this.renderCount,g=Date.now(),y=null,_="";if(c.forEach(function(i){i.html=t.substitute(a(i.tpl,e),{city:s.cityName,cityEllipsis:s.cityEllipsis}),_+=i.html}),o.setStorage("ALITRIP_H5_HOME_CACHE_APP",window.ALITRIP_H5_HOME_CACHE_APP),o.setStorage("ALITRIP_H5_HOME_CACHE_TPLS",c,!0),o.setStorage("ALITRIP_H5_HOME_CACHE_VERSION",window.HOME_PAGE_VERSION),o.setStorage("ALITRIP_H5_HOME_CACHE_EXPIRE",g+2592e5),!f&&!m||!d||!d.length||h!==window.ALITRIP_H5_HOME_CACHE_APP||u!==window.HOME_PAGE_VERSION||!p||g>p)return y=l,this.destroyMods(y),r.html(_),y;if(i=this.diffHTML(c,d),y=i.rerender||[],y.push({id:"trip_home_channel_onsale"}),window.isInAlipay||y.push({id:"trip_home_guess_favor_contents"}),console.log(i),i.modify&&(this.destroyMods(y),i.del.forEach(function(e){n=t.one("."+e.id),n&&n.remove(!0)}),i.add.forEach(function(t){r.append(t.html)}),i.update.forEach(function(e){n=t.one("."+e.id),n&&n.replaceWith(e.html)})),i.resort){var v=document.createDocumentFragment();c.forEach(function(e){n=t.one("."+e.id),n&&v.appendChild(n[0])}),r[0].innerHTML="",r[0].appendChild(v)}return y},diffHTML:function(t,e){var i,n={},s={},r=[],a=[],o=[],c=!1;return t&&t.length&&e&&e.length&&(t.forEach(function(t){i=t.id,n[i]=t}),e.forEach(function(t){i=t.id,s[i]=t,n[i]?((n[i].html!==t.html||"trip_home_sale"===i)&&o.push(n[i]),n[i].i!==t.i&&(c=!0)):(a.push(t),c=!0)}),t.forEach(function(t){i=t.id,s[i]||(r.push(t),c=!0)})),addHomePerf("addMod",r.length),addHomePerf("delMod",a.length),addHomePerf("updateMod",o.length),{add:r,del:a,update:o,resort:c,rerender:r.concat(o),modify:r.length||a.length||o.length}},renderMods:function(t){var e=this;t&&t.length&&t.forEach(function(t){t=d[t.id],t&&t.init(e,e.dataMap[t.id])})},destroyMods:function(t){t&&t.length&&t.forEach(function(t){t=d[t.id],t&&t.destroy()})},_getTpls:function(e,i){var n,s,r,a,c,h=this,l=e.sections,d=[];return e.tpls=window.ALITRIP_H5_HOME_TPLS,t.each(l,function(t,l){if(n=t.id,t.index=l,s=c="trip_home_section_divider"===n,/trip_home_subcategory_[a-zA-Z]+_title_bar/i.test(n)&&(n="trip_home_subcategory_common_title_bar"),/trip_home_subcategory_[a-zA-Z]+_items/i.test(n)&&(n="trip_home_subcategory_common_items"),/trip_home_dachu/i.test(n)&&(n="trip_home_activiting"),/trip_home_travel_[a-zA-Z]+_title_bar/i.test(n)&&(n="trip_home_travel_common_title_bar",t.items&&t.items.forEach(function(e){t.titleColor=e.titleColor})),/trip_home_travel_[a-zA-Z]+_banner/i.test(n)&&(n="trip_home_travel_common_banner"),/trip_home_travel_[a-zA-Z]+_product_items/i.test(n)&&(n="trip_home_travel_common_product_items"),/trip_home_travel_[a-zA-Z]+_parellel_banner/i.test(n)&&(n="trip_home_travel_common_parellel_banner"),/trip_home_travel_[a-zA-Z]+_tags/i.test(n)){n="trip_home_travel_common_tags";var u="trip_home_travel_"+t.id.match(/trip_home_travel_([a-zA-Z]+)_tags/)[1]+"_title_bar",p=h.dataMap[u]&&h.dataMap[u].titleColor;t.items&&t.items.forEach(function(t){t.color=p})}return/trip_home_travel_[a-zA-Z]+_dest/i.test(n)&&(n="trip_home_travel_common_dest"),/trip_home_channel/i.test(n)&&(n="trip_home_channel",t&&t.items&&t.items.forEach(function(t){!t||"Sale"!=t.trackname&&"TimerSale"!=t.trackname||(h.dataMap.trip_home_channel_onsale=h.onsaleData=t)})),"trip_nearby_scenic_spots_simple"===n&&(h.aroundScenicData=t.items.map(function(t){return{scenicId:t.scenicId,bucketId:t.bucketId,pvid:t.pvid,scm:t.scm}}),o.setStorage("ALITRIP_H5_HOME_AROUND_SCENIC",h.aroundScenicData,!0)),e.tpls["J_tpl_"+n]&&(r={i:d.length,id:t.id+(c?"_"+l:""),tpl:"{@include tpls.J_tpl_"+n+", sections["+l+"]}",divider:s},d.push(r),i&&i===n)?void(a=r):void 0}),i?a||null:(window.isInAlipay?d.push({i:d.length,id:"trip_home_footer",tpl:"{@include tpls.J_tpl_trip_home_footer, serverYear}",divider:!1}):d.push({i:d.length,id:"trip_home_h5_tabbar",tpl:"{@include tpls.J_tpl_trip_home_h5_tabbar, tabbar}",divider:!1}),d)},renderLazyload:function(){this.lazyload?this.lazyload.update():this.lazyload=new h({nodes:".lazyload",delay:60,heightOnly:!0,autoPause:!0,autoDestroy:!1,preciseMode:!!r.android,loadOnTouchMove:r.ios,onload:t.bind(this.lazyloadImage,this)})},lazyloadImage:function(e){var e=t.one(e),i=e[0],n="img"===i.nodeName.toLowerCase(),s=e.attr("data-src");s&&(this.isSupportWebp&&!/webp$/.test(s)&&(s+="_.webp"),e.hasClass("fade")?(n?i.onload=i.onerror=function(){i&&(i.style.opacity="1",i.onload=i.onerror=null)}:(i=new Image,i.onload=i.onerror=function(){e&&e[0]&&i&&(e[0].style.opacity="1",i.onload=i.onerror=null)}),setTimeout(function(){e[0]&&e.removeClass("fade")},450)):n?i.style.opacity="1":e[0].style.opacity="1",i.src=s,n||(e[0].style.backgroundImage="url("+s+")"),e.attr("data-src",""),e.removeClass("lazyload")),this.sendExposureData(e)},sendExposureData:function(t){var e=t.attr("data-expos"),i=this.exposureData=this.exposureData||[];e&&(e+="&logType=view&actionTime="+Date.now(),i.push(e)),i.length>=8&&this.sendExposureDataToGoldLog()},sendExposureDataToGoldLog:function(){var t=this.exposureData;t&&t.length&&(MT.Tracker.sendGoldLog("tbtrip.713.8","H46807202","expos="+encodeURIComponent(JSON.stringify(t))),t.length=0)},renderGoToTop:function(){function e(){n(function(){i.toggleClass("go-to-top-show",window.pageYOffset>window.innerHeight/2)})}if(this.goToTopRendered||window.isInAlipay)return!0;if(t.one(".dbl11-tabbar"))return this.goToTopRendered=!0;var i=t.one(".go-to-top");i.removeClass("hidden"),e(),t.one(window).on("scroll",e,this),i.on("tap",this.scrollToTop,this)},scrollToTop:function(){var t=function(t,e,i){return t+(e-t)*i},e=function(t){return-Math.cos(t*Math.PI)/2+.5},i=function(i,s,r){i=i||0,s=s||200,r=r||e;var a=window.pageYOffset,o=Date.now(),c=o+s,h=function(){var r=+new Date,l=r>c?1:(r-o)/s;window.scrollTo(0,t(a,i,e(l))),r>c||n(h)};h()};i()},bind:function(){this.bindModsClick()},bindModsClick:function(){this.container.delegate("tap click","a",this._onModClick,this),this.container.delegate("tap click",".favor-item",this._onModClick,this),this.container.delegate("tap click",".headline-mask",this._onModClick,this)},bindHeaderScroll:function(){if(s.hasClass("alipay-skin")&&(this.checkHeaderScroll(),r.ios&&t.one(window).on("touchmove",this.checkHeaderScroll,this),t.one(window).on("scroll",this.checkHeaderScroll,this),"complete"!==document.readyState)){var e=function(){var i,s,r=window.pageYOffset,a=20;i=function(){s=setTimeout(function(){a--,r!=window.pageYOffset?(clearTimeout(s),window.scrollTo(window.pageXOffset,window.pageYOffset+1),n(function(){window.scrollTo(window.pageXOffset,window.pageYOffset-1)})):a?i():clearTimeout(s)},150)},i(),t.one(window).detach("load",e,this)};t.one(window).on("load",e,this)}},checkHeaderScroll:function(t){var e=this,i=function(){window.pageYOffset>=70?(!e.isHeaderFixed&&s.addClass("header-fixed",window.pageYOffset>=70),e.isHeaderFixed=!0):(e.isHeaderFixed&&s.removeClass("header-fixed",window.pageYOffset>=70),e.isHeaderFixed=!1)};r.ios?i():n(i)},_onModClick:function(e){var i=this,n=/^.*\/(pages|trip\/home)\//i,s=location.href.match(n);!!navigator.userAgent.match(/AliApp\(TB/gi);if("tap"==e.type){this.sendExposureDataToGoldLog();var r,h,l,d,u=e.currentTarget,p=u.getAttribute("href"),f=u.getAttribute("data-crosscallback"),m=t.one(u),g=o.getParam("e");o.getParam("ttid");if(f&&this.passCrossDataBack(f),m.parent(".category")&&(g&&(p=p+(p.match(/\?/)?"&":"?")+"e="+encodeURIComponent(g)),"1"==u.getAttribute("data-refresh")&&(i.CATEGORY_NEED_REFRESH=!0)),m.parent(".around-scenic")&&(h=Number(e.currentTarget.getAttribute("data-index")),r=this.aroundScenicData||o.getStorage("ALITRIP_H5_HOME_AROUND_SCENIC",!0),r&&r[h]&&(l=a("{@if bucketId}&bucketId=${bucketId}{@/if}{@if scm}&scm=${scm}{@/if}{@if pvid}&pvid=${pvid}{@/if}",r[h]),l=p.match(/\?/)?l:l.replace(/^&/,"?"),p+=l),g&&(p=p+(p.match(/\?/)?"&":"?")+"e="+encodeURIComponent(g))),(d=m.parent(".headline"))&&(m=d.one(".m-simpleslide-current a")||d.one("a"),u=m[0],p=u.href||""),(d=m.parent(".m-simpleslide-item"))&&d[0]._cloneNode&&(m=t.one(d[0]._cloneNode).one("a"),u=m[0],p=u.href||""),p.match(/trip\/home\//i)&&s&&s[0]&&(p=p.replace(/^.*trip\/home\//,s[0])),p&&(p=p.replace(/&?spm\=[0-9A-Za-z\.]+/gi,"").replace(/\?&/,"?").replace(/\?$/,"")),p){if(window.top&&window.top.location&&window.self&&window.self.location&&window.top.location!==window.self.location)return void(window.top.location.href=o.addTtidAndSpm(p,u));c.goTo({href:p,triggerNode:u,callback:function(e){e&&e.getCityFromCityList&&t.one(document).fire("AlitripGetCityBack",{data:e})}})}}else e.preventDefault()},checkSupportWebp:function(t){var e,i,n=new Image;n.onload=n.onerror=function(){e||(e=!0,i=2===n.width&&2===n.height,t(i))},setTimeout(function(){e||(e=!0,i=!1,t(i))},16),n.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"},registerJuicer:function(){var e=this;a.register("href_h5",function(t,e){return(e&&e.href_h5||t||"").trim()}),a.register("channel_href_h5",function(t,e){return e.bizData&&e.bizData[0]&&(e=e.bizData[0]),e&&e.href_h5||t}),a.register("channel_data",function(t,e){return t.bizData&&t.bizData[0]&&(t=t.bizData[0]),t&&t[e]?"pricePrefix"===e?"\uffe5":t[e]:""}),a.register("favor_track",function(e,i,n){var s=[];return e&&(e.locId=n+(Number(i)||0)+1,t.each(e,function(t,e){s.push(e+"="+encodeURIComponent(t))})),s.join("&")}),a.register("image_optim",function(t,i,n,s){var a,o,c="",h=/_(\d+x\d+)?(q\d+)?\.(jpg|jpeg|png|gif)$/i,l=s===!1&&r.android?!1:!0;return t=(t||"").trim(),t=t.replace(/^http[s]?:/i,"").replace(/img\.taobao\.com/i,"img.alicdn.com"),(a=t.match(h))&&(t=t.replace(h,""),i=i||a[0],n=n||a[1],o=a[2]),i&&(c+=i),n&&(c+=n),c&&(c="_"+c+".jpg"),e.isSupportWebp&&l&&(c+="_.webp"),t&&(t+=c),t}),a.register("lowercase",function(t){return t.toLowerCase()}),a.register("parseInt",function(t,e){return t=t||e||0,parseInt(t,10)}),a.register("distance_build",function(t){var t=Number(t);return!isNaN(t)&&t>0?1>t?"\u8ddd\u79bb"+Math.round(1e3*t)+"\u7c73":(t=t.toFixed(1).replace(/\.(\d)/,function(t){return t.substring(1)>0?t:""}),"\u8ddd\u79bb"+t+"\u516c\u91cc"):void 0}),a.register("city_url",function(t){var i=location.href.replace(/(\?|\#).*$/,""),n=i.match(/^.*\/pages\//)||i.match(/^.*\/trip\/home\//),s=e.currentCity,r=s&&s.longitude&&s.latitude?s.longitude+","+s.latitude:"";return n=n?n[0]:"//h5.m.taobao.com/trip/home/",n+"city/index.html?backUrl="+encodeURIComponent(location.href)+"&sourcePoint="+encodeURIComponent(r)}),a.register("search_url",function(t,i){var n=location.host.match("waptest|wapa"),s=i.match(/\u201c[\s\S]*\u201d/),r=e.currentCity,a=r&&r.cityName||"";return s&&s.length&&(i=s[0].replace(/\u201c|\u201d/g,"")),n=n&&n[0]||"m",i="\u76ee\u7684\u5730/\u666f\u70b9/\u9152\u5e97/\u95e8\u7968"===i?"":encodeURIComponent(i.replace(/\n/g,"")),"//h5."+n+".taobao.com/trip/home-searchlist/suggest/index.html?cityName="+a+(i?"&placeholder="+i:"")}),a.register("scenic_url",function(t){return a("//h5.m.taobao.com/trip/ticket/scenic-spot/detail.html?scenicTitle=${name}&scenicId=${scenicId}&from=h5home",t)}),a.register("channel_title",function(t,e){if(t)return t.length>6?t.substring(0,6):t;switch(e.trackname){case"FlightSale":return"\u7279\u4ef7\u673a\u7968";case"HotelSale":return"\u7279\u60e0\u9152\u5e97";case"Sale":case"TimerSale":return"\u53bb\u62a2\u8d2d";case"MemberSale":return"\u4f1a\u5458\u4e13\u4eab";case"PreSale":return"\u8d85\u7ea7\u9884\u552e";case"FoodSale":return"\u81ea\u52a9\u9910";case"CityWideSale":return"\u540c\u57ce\u6d3b\u52a8";case"CruiseSale":return"\u90ae\u8f6e";case"IntShoppingSale":return"\u73af\u7403\u8d2d\u7269";default:return""}}),a.register("tracknameToSpm",function(t,e){switch(t){case"Sale":case"TimerSale":return"1998613475";case"HotelSale":return"1998936349";case"FlightSale":return"1998936350";case"MemberSale":return"1998936351";case"PreSale":return"1998936352";case"FoodSale":return"1998936353";case"CityWideSale":return"1998936354";case"CruiseSale":return"1998936355";case"IntShoppingSale":return"1998936356"}switch(e){case"trip_home_activiting":return"1998734342";case"trip_home_dachu_title_bar1":return"1998982146";case"trip_home_dachu_title_bar2":return"1998982147";case"trip_home_dachu_contents":return"1998982148";case"trip_home_subcategory_hotel_items":return"1998980421";case"trip_home_subcategory_traffic_items":return"1998980422";case"trip_home_subcategory_vacation_items":return"1998980423";case"trip_home_travel_weekend_title_bar":return"1998936315";case"trip_home_travel_weekend_banner":return"1998936322";case"trip_home_travel_weekend_product_items":return"1998936323";case"trip_home_travel_weekend_parellel_banner":return"1998936324";case"trip_home_travel_weekend_banner2":return"1998936325";case"trip_home_travel_dom_title_bar":return"1998936326";case"trip_home_travel_dom_banner":return"1998936327";case"trip_home_travel_dom_product_items":return"1998936328";case"trip_home_travel_dom_parellel_banner":return"1998936329";case"trip_home_travel_dom_banner2":return"1998936330";case"trip_home_travel_dom_tags":return"1998936331";case"trip_home_travel_int_title_bar":return"1998936332";case"trip_home_travel_int_dest":return"1998936333";case"trip_home_travel_int_tags":return"1998936334";case"trip_home_travel_int_banner":return"1998936335";case"trip_home_travel_int_product_items":return"1998936336";case"trip_home_travel_int_parellel_banner":return"1998936337";case"trip_home_travel_int_banner2":return"1998936338"}return""}),a.register("stringify",function(t){return JSON.stringify(t)})}}});KISSY.add("h5-home/pages/home/offline",function(t,require,e,i){"use strict";var n=require("ua"),s=require("jsbridge"),a=require("./util"),r={"home/home/index":1,"home/search/index":1,"home/city/index":1,"home/preparation/index":1,"flight/search/index":1,"flight/onsale/index":1,"hotel/search/index":1,"holiday/search/search":1,"destination/home/index":1,"ticket/search/index":1,"ticket/scenic-spot/detail":1,"visa/search/index":1,"train/search/index":1,"member/member-center/index":1,"inn/search/index":1,"onsale/index/index":1},o={home:"triphome"},c={flight:"20000135",train:"20000143",hotel:"20000139"},h={init:function(){this.app=a.getApp(),this.tmallVersion=a.getVersion("AliApp\\(TM"),this.taobaoVersion=a.getVersion("AliApp\\(TB"),this.alipayVersion=a.getVersion("AlipayClient")},getOfflineInfo:function(t){var e,i,s=a.getUrlInfo(t),h=t,l=!1;return t.match(/waptest|wapa/i)&&!location.search.match(/offline=true/i)?{offline:!1,origin:h,appid:"",href:""}:(r[s.pagename]&&("taobao"===this.app&&(n.ios&&a.compareVersion(this.taobaoVersion,"5.0.1")>=0||n.android&&a.compareVersion(this.taobaoVersion,"5.1.3")>=0)||"tmall"===this.app?(l=!0,e="http://h5.m.taobao.com/app/"+(o[s.category]||s.category)+"/pages/"+s.page+"/"+s.subpage+".html"+s.search+s.hash):"alipay"===this.app&&window.AlipayJSBridge&&a.compareVersion(this.alipayVersion,"8.1.0")>=0&&(i=c[s.category])&&(e="/build_offline/pages/"+s.page+"/"+s.subpage+".html"+s.search+s.hash,"flight"===s.category&&a.compareVersion(this.alipayVersion,"8.4.0")<0?(l=!0,e.replace("build_offline","www")):(n.ios&&a.compareVersion(this.alipayVersion,"8.5.0")>=0||n.android&&a.compareVersion(this.alipayVersion,"8.6.0")>=0)&&(l=!0))),{offline:l,origin:h,appid:i,href:e})},goTo:function(t){var e=this.getOfflineInfo(t.href),i=e.offline?e.href:t.href,n=t.triggerNode,r=t.callback,o=t.ttid||a.getParam("ttid");e.offline&&e.appid?(i=a.addTtidAndSpm(i,n),window.AlipayJSBridge.call("startApp",{appId:e.appid,param:{url:i,ttid:o,backBehavior:"back"},closeCurrentApp:!1},function(t){window.location.href="alipays://platformapi/startApp?appId="+e.appid+"&url="+i})):window.alipay&&"alipay"===h.app?(i=a.addTtidAndSpm(i,n),window.alipay.navigation.pushWindow(i)):s.goTo({href:i,triggerNode:n,callback:r})}};h.init(),i.exports=h});KISSY.add("h5-home/widgets/lazyload/lite",function(t){function e(t){this.init.apply(this,arguments)}return t.augment(e,{init:function(e){this._config={nodes:[],container:window,delay:30,margin:15,onload:null,heightOnly:!1,preciseMode:!1,useTouchMove:!1,autoPause:!1,autoDestroy:!0},this.config(e),this._container=t.one(this._config.container),this._container[0]===document.body&&(this._container=t.one(window)),this._containerIsWindow=this._container[0]===window,this.refresh(),this.bind(),this.check()},destroy:function(){return this.detach(),this._nodes=null,this._config=null,delete this._nodes,delete this._config,delete this._delayTimeout,this.destroyed=!0,this},config:function(e){return this._config=t.merge(this._config,e),this},refresh:function(){var t=this._config.nodes,e=this._containerIsWindow?document:this._container[0];return t="string"==typeof t?e.querySelectorAll(t):t,t=t&&t.length?Array.prototype.slice.call(t,0):[],this._nodes=t.filter(function(t){return!t._lazyloaded}),this},bind:function(){var e=t.one(window),i=this.container,n=this._containerIsWindow,s=this._config.useTouchMove;return e.on("resize",this._onResize,this),e.on("scroll",this._onScroll,this),e.on("orientationchange",this._onOrientationChange,this),!n&&i.on("scroll",this._onScroll,this),s&&i.on("touchmove",this._onScroll,this),this},detach:function(){var e=t.one(window),i=this.container,n=this._containerIsWindow,s=this._config.useTouchMove;return e.detach("resize",this._onResize,this),e.detach("scroll",this._onScroll,this),e.detach("orientationchange",this._onOrientationChange,this),!n&&i.detach("scroll",this._onScroll,this),s&&i.detach("touchmove",this._onScroll,this),this},check:function(){if(clearTimeout(this._delayTimeout),this._delayTimeout=null,this.paused||this.destroyed)return this;for(var t,e,i,n,s=this._containerIsWindow,a=this._container,r=s?window.innerWidth:a.width(),o=s?window.innerHeight:a.height(),c=this._config,h=c.margin,l=c.preciseMode,d=c.autoPause,u=c.autoDestroy,p=c.heightOnly,f=c.onload||this._config.onLoad,m=this._nodes,g=0;g<m.length;)t=m[g++],e=t.style.display||document.defaultView.getComputedStyle(t,null).getPropertyValue("display"),"none"!==e&&(i=t.getBoundingClientRect(),(i.top||i.bottom||i.left||i.right)&&(n=o+h>=i.top&&(p||r+h>=i.left)&&(!l||i.bottom+h>=0&&(p||i.right+h>=0)),n&&(m.splice(--g,1),t._lazyloaded=!0,f&&f.call(this,t))));return d&&!m.length&&this.pause(),u&&!m.length&&this.destroy(),this},pause:function(){return this.paused||(this.detach(),this.paused=!0),this},resume:function(){return this.paused&&(this.bind(),this.paused=!1),this},update:function(){this.refresh(),this.resume(),this.check()},_interval:function(){var e=this._config.delay;"number"==typeof e?!this._delayTimeout&&(this._delayTimeout=setTimeout(t.bind(this.check,this),e)):this.check()},_onResize:function(){this._interval()},_onScroll:function(){this._interval()},_onOrientationChange:function(){setTimeout(t.bind(this._interval,this),400)}}),e});KISSY.add("h5-home/pages/home/mods/banner/index",function(t,require,e,i){var n=require("../../../../widgets/simple-slide/"),s=require("../../../../widgets/orientation/");i.exports={id:"trip_home_banner",init:function(e){(!this.rendered||this.destroyed)&&(this.host=e,this.container=t.one(".banner"),this.container&&this.render())},render:function(){var t=this.container.all(".banner-scroller li"),e=t.length;e>1&&this.renderSlide(),this.rendered=!0},renderSlide:function(){var t=this;this.slide=new n({container:".banner",items:".banner-scroller li",triggers:".banner-trigger li",timeout:5e3,circular:!0,autoPlay:!0}),this.slide.render(),this.orientation=s.create(),this.orientation.change(function(e){t.slide.refresh(),t.slide.play()},!0)},destroy:function(){this.slide&&this.slide.stop(),this.slide&&this.slide.destroy(),this.orientation&&this.orientation.destroy(),this.slide=null,this.orientation=null,this.destroyed=!0}}});KISSY.add("h5-home/widgets/simple-slide/index",function(t,e,i){function n(){this.init.apply(this,arguments)}var s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();return t.augment(n,{init:function(e){this.config(e),this.container=t.one(this.get("container")),this.set("container",this.container),this.circular=this.get("circular"),this.circularCopy=this.get("circularCopy")===!1?!1:!0,this.duration=this.get("duration"),this.autoPlay=this.get("autoPlay"),this.vertical=this.get("vertical"),this.timeout=this.get("timeout"),this.width=parseFloat(this.get("width")),this.height=parseFloat(this.get("height")),this.ratio=this.get("ratio"),this.currentCls=this.get("currentCls"),this.activeCls=this.get("activeCls"),this.scrollerPage=this.vertical?"pageY":"pageX",this.items=this._getItems(),this.triggers=this._getTriggers(),this.itemList=this.items.parent(),this.scrollCon=this.itemList.parent(),this.total=this.items.length,this.len=this.total,this.scrolling=!1},config:function(e){this._config=t.merge({container:null,items:"li",triggers:"",currentCls:"m-simpleslide-current",activeCls:"m-simpleslide-active",circular:!1,autoPlay:!1,bounce:!0,snap:!0,snapThreshold:.3,duration:400,timeout:3e3,index:0,width:0,height:0,ratio:0,onSwitch:null},e)},destroy:function(){this.container.detach("touchmove",this._preventScroll,this),this.stop(!0),this.scroller&&this.scroller.destroy()},render:function(){this.renderUI(),this.bindUI(),this.syncUI()},renderUI:function(){this._getSize(),this._fixCircular(),this._renderCls(),this._renderStyle(),this._renderScroller()},bindUI:function(){this.scroller.on("scrollEnd",t.bind(this._onScrollEnd,this)),this.scroller.on("beforeScrollStart",t.bind(this._onScrollStart,this)),this.scroller.on("scrollStart",t.bind(this._onScrollStart,this)),this.vertical&&this.container.on("touchmove",this._preventScroll,this)},syncUI:function(){var t=this.get("index"),e=this.getRealIndex(t);this.scrollTo(e),this._syncCls({from:t,index:t}),this.play()},get:function(t){return this._config[t]},set:function(t,e){var i=this.get(t);i!==e&&(this._config[t]=e,this.change(t,e,i))},change:function(t,e,i){var n="_after"+t.substring(0,1).toUpperCase()+t.substring(1)+"Change";return this[n]&&this[n]({newVal:e,prevVal:i}),this},scrollTo:function(t,e){return this.scroller&&(this.scrolling=!0,this.scroller.goToPage(this.vertical?0:t,this.vertical?t:0,e||0),e||(this.scrolling=!1,this.set("index",this.getIndex(t)))),this},play:function(t){var e,i=this;return t&&(this.autoPlay=!0),this.autoPlay&&(e=function(){s(function(){clearTimeout(i.timer),i.next()})},this.stop(),this.timer=setTimeout(e,this.timeout)),this},stop:function(t){return clearTimeout(this.timer),delete this.timer,t&&(this.autoPlay=!1),this},next:function(t){var e=this.getRealIndex(this.get("index")+1);return this.scrollTo(e,"undefined"==typeof t?this.duration:t)},prev:function(t){var e=this.getRealIndex(this.get("index")-1);return this.scrollTo(e,"undefined"==typeof t?this.duration:t)},refresh:function(){var t,e=this.getRealIndex(this.get("index"));return this._getSize(),this._renderStyle(),this.scroller&&(this.scroller.refresh(),t=this.scroller.currentPage[this.scrollerPage],t===e?(this.scrollTo(e),this.play()):this.scrollTo(t)),this},getIndex:function(t){return this.circular&&(t-=1,0>t?t=this.total-1:t===this.total&&(t=0)),t},getRealIndex:function(t){var e=this.circular?this.len:this.total;return t=this.circular?t+1:t,t%e},_renderCls:function(){this.container.addClass("m-simpleslide"),this.itemList.addClass("m-simpleslide-list"),this.items.addClass("m-simpleslide-item"),this.triggers&&this.triggers.addClass("m-simpleslide-trigger")},_renderStyle:function(){this.scrollCon.css("overflow","hidden"),this.scrollCon.css("-webkit-transform","translateZ(0)"),this.itemList.css(this.vertical?{width:this.cWidth+"px",height:this.cHeight*this.len+"px"}:{width:this.cWidth*this.len+"px",height:this.cHeight+"px"}),this.items.css({"float":this.vertical?"none":"left",width:this.cWidth+"px",height:this.cHeight+"px"})},_renderScroller:function(){var t=this.get("snap"),e=this.get("bounce"),n=this.get("vertical"),s=this.circular,r=this.get("snapThreshold");this.scroller=new i(this.scrollCon[0],{snap:t,snapThreshold:r,momentum:!1,bounce:e&&!s,eventPassthrough:n?"horizontal":"vertical",preventDefault:!1,scrollX:n?!1:!0,scrollY:n?!0:!1})},_getItems:function(){var t=this.get("items");return"string"==typeof t&&(t=this.container.all(t)),t},_getTriggers:function(){var t=this.get("triggers");return t?"string"==typeof t&&(t=this.container.all(t)):t=null,t},_getSize:function(){this.cWidth=this.width||this.scrollCon.width(),this.cHeight=this.height||this.scrollCon.height(),this.ratio&&(this.cHeight=this.cWidth*this.ratio)},_fixCircular:function(){var t,e,i,n;this.circular&&(this.circularCopy?(t=this.items.item(0),e=this.items.item(this.total-1),i=t.clone(!0),n=e.clone(!0),i[0]._cloneNode=t[0],n[0]._cloneNode=e[0],this.itemList.prepend(n),this.itemList.append(i),this.items=this._getItems(),this.len=this.items.length):this.total=this.len-2)},_fixCircularPos:function(t){var e=this,i=t;this.circular&&e.scrollTo(i)},_syncCls:function(t){var e=this.getRealIndex(t.from),i=this.getRealIndex(t.index);this.items.item(e).removeClass(this.currentCls),this.items.item(i).addClass(this.currentCls),this.triggers&&(this.triggers.item(t.from).removeClass(this.activeCls),this.triggers.item(t.index).addClass(this.activeCls))},_preventScroll:function(t){t.preventDefault()},_onScrollStart:function(t){this.scrolling=!0},_onScrollEnd:function(t){var e=this.scroller;index=this.getIndex(e.currentPage[this.scrollerPage]),this.scrolling=!1,this.set("index",index)},_afterIndexChange:function(t){var e,i=this.getRealIndex(t.newVal);this._fixCircularPos(i),e={from:t.prevVal,to:t.newVal,index:t.newVal,realIndex:i},this._syncCls(e),this.play(),this.onSwitch&&this.onSwitch(e)}}),n},{requires:["node","../iscroll/"]});KISSY.add("h5-home/widgets/iscroll/index",function(){return function(t,e,i){function s(t,i){this.wrapper="string"==typeof t?e.querySelector(t):t,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0,click:!0};for(var s in i)this.options[s]=i[s];this.translateZ=this.options.HWCompositing&&o.hasPerspective?" translateZ(0)":"",this.options.useTransition=o.hasTransition&&this.options.useTransition,this.options.useTransform=o.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?o.ease[this.options.bounceEasing]||o.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}var n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},o=function(){function s(t){return r===!1?!1:""===r?t:r+t.charAt(0).toUpperCase()+t.substr(1)}var n={},o=e.createElement("div").style,r=function(){for(var t,e=["t","webkitT","MozT","msT","OT"],i=0,s=e.length;s>i;i++)if(t=e[i]+"ransform",t in o)return e[i].substr(0,e[i].length-1);return!1}();n.getTime=Date.now||function(){return(new Date).getTime()},n.extend=function(t,e){for(var i in e)t[i]=e[i]},n.addEvent=function(t,e,i,s){t.addEventListener(e,i,!!s)},n.removeEvent=function(t,e,i,s){t.removeEventListener(e,i,!!s)},n.momentum=function(t,e,s,n,o,r){var a,h,c=t-e,l=i.abs(c)/s;return r=void 0===r?6e-4:r,a=t+l*l/(2*r)*(0>c?-1:1),h=l/r,n>a?(a=o?n-o/2.5*(l/8):n,c=i.abs(a-t),h=c/l):a>0&&(a=o?o/2.5*(l/8):0,c=i.abs(t)+a,h=c/l),{destination:i.round(a),duration:h}};var a=s("transform");return n.extend(n,{hasTransform:a!==!1,hasPerspective:s("perspective")in o,hasTouch:"ontouchstart"in t,hasPointer:navigator.msPointerEnabled,hasTransition:s("transition")in o}),n.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion),n.extend(n.style={},{transform:a,transitionTimingFunction:s("transitionTimingFunction"),transitionDuration:s("transitionDuration"),transitionDelay:s("transitionDelay"),transformOrigin:s("transformOrigin")}),n.hasClass=function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)");return i.test(t.className)},n.addClass=function(t,e){if(!n.hasClass(t,e)){var i=t.className.split(" ");i.push(e),t.className=i.join(" ")}},n.removeClass=function(t,e){if(n.hasClass(t,e)){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(i," ")}},n.offset=function(t){for(var e=-t.offsetLeft,i=-t.offsetTop;t=t.offsetParent;)e-=t.offsetLeft,i-=t.offsetTop;return{left:e,top:i}},n.preventDefaultException=function(t,e){for(var i in e)if(e[i].test(t[i]))return!0;return!1},n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,touchcancel:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return i.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var e=4;return(t-=1)*t*((e+1)*t+e)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var e=.22,s=.4;return 0===t?0:1==t?1:s*i.pow(2,-10*t)*i.sin(2*(t-e/4)*i.PI/e)+1}}}),n.tap=function(t,i){var s,n=t.changedTouches?t.changedTouches[0]:t;t.target;s=e.createEvent("Event"),s.initEvent(i,!0,!0),s.pageX=n.pageX,s.pageY=n.pageY,s.screenX=n.screenX,s.screenY=n.screenY,s.clientX=n.clientX,s.clientY=n.clientY,s.preventDefault=function(){try{this.constructor.prototype.preventDefault.call(this),t.preventDefault()}catch(e){}},t.target.dispatchEvent(s)},n.click=function(t){var i,s=t.changedTouches?t.changedTouches[0]:t,n=t.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(i=e.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,t.view,1,s.screenX,s.screenY,s.clientX,s.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),i.pageX=s.pageX,i.pageY=s.pageY,i._constructed=!0,i.preventDefault=function(){try{this.constructor.prototype.preventDefault.call(this),t.preventDefault()}catch(e){}},n.dispatchEvent(i))},n}();s.prototype={version:"5.1.1",_init:function(){this._initEvents(),this.options.snap&&this._initSnap()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if(!(1!=o.eventType[t.type]&&0!==t.button||!this.enabled||this.initiated&&o.eventType[t.type]!==this.initiated)){!this.options.preventDefault||o.isBadAndroid||o.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var e,s=t.touches?t.touches[0]:t;this.initiated=o.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=o.getTime(),this.isInTransition?(this.isInTransition=!1,e=this.getComputedPosition(),this._translate(i.round(e.x),i.round(e.y)),this._execEvent("scrollEnd")):this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=s.pageX,this.pointY=s.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&o.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var e,s,n,r,a=t.touches?t.touches[0]:t,h=a.pageX-this.pointX,c=a.pageY-this.pointY,l=o.getTime();if(this.pointX=a.pageX,this.pointY=a.pageY,this.distX+=h,this.distY+=c,n=i.abs(this.distX),r=i.abs(this.distY),!(l-this.endTime>300&&10>n&&10>r)){if(this.directionLocked||this.options.freeScroll||(n>r+this.options.directionLockThreshold?this.directionLocked="h":r>=n+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);h=0}h=this.hasHorizontalScroll?h:0,c=this.hasVerticalScroll?c:0,e=this.x+h,s=this.y+c,(e>0||e<this.maxScrollX)&&(e=this.options.bounce?this.x+h/3:e>0?0:this.maxScrollX),(s>0||s<this.maxScrollY)&&(s=this.options.bounce?this.y+c/3:s>0?0:this.maxScrollY),this.directionX=h>0?-1:0>h?1:0,this.directionY=c>0?-1:0>c?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(e,s),l-this.startTime>300&&(this.startTime=l,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(t){if(this.enabled&&o.eventType[t.type]===this.initiated){this.options.preventDefault&&!o.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var e,s,n=t.changedTouches?t.changedTouches[0]:t,r=o.getTime()-this.startTime,a=i.round(this.x),h=i.round(this.y),c=i.abs(a-this.startX),l=i.abs(h-this.startY),p=0,u="";if(this.isInTransition=0,this.initiated=0,this.endTime=o.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(a,h),!this.moved)return t.pageX=n.pageX,t.pageY=n.pageY,t.clientX=n.clientX,t.clientY=n.clientY,this.options.tap&&o.tap(t,this.options.tap),this.options.click&&o.click(t),void this._execEvent("scrollCancel");if(this._events.flick&&200>r&&100>c&&100>l)return void this._execEvent("flick");if(this.options.momentum&&300>r&&(e=this.hasHorizontalScroll?o.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:a,duration:0},s=this.hasVerticalScroll?o.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:h,duration:0},a=e.destination,h=s.destination,p=i.max(e.duration,s.duration),this.isInTransition=1),this.options.snap){var d=this._nearestSnap(a,h);this.currentPage=d,p=this.options.snapSpeed||i.max(i.max(i.min(i.abs(a-d.x),1e3),i.min(i.abs(h-d.y),1e3)),300),a=d.x,h=d.y,this.directionX=0,this.directionY=0,u=this.options.bounceEasing}return a!=this.x||h!=this.y?((a>0||a<this.maxScrollX||h>0||h<this.maxScrollY)&&(u=o.ease.quadratic),void this.scrollTo(a,h,p,u,this.options.momentum&&4==this.options.probeType)):void this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,i=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),e==this.x&&i==this.y?!1:(this.scrollTo(e,i,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=o.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){if(this._events[t]){var i=this._events[t].indexOf(e);i>-1&&this._events[t].splice(i,1)}},_execEvent:function(t){if(this._events[t]){var e=0,i=this._events[t].length;if(i)for(;i>e;e++)this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,i,s){t=this.x+t,e=this.y+e,i=i||0,this.scrollTo(t,e,i,s)},scrollTo:function(t,e,i,s,n){s=s||o.ease.circular,this.isInTransition=!n&&this.options.useTransition&&i>0,!n&&(!i||this.options.useTransition&&s.style)?(this._transitionTimingFunction(s.style),this._transitionTime(i),this._translate(t,e)):this._animate(t,e,i,s.fn)},scrollToElement:function(t,e,s,n,r){if(t=t.nodeType?t:this.scroller.querySelector(t)){var a=o.offset(t);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,s===!0&&(s=i.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),n===!0&&(n=i.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=s||0,a.top-=n||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,e=void 0===e||null===e||"auto"===e?i.max(i.abs(this.x-a.left),i.abs(this.y-a.top)):e,this.scrollTo(a.left,a.top,e,r)}},_transitionTime:function(t){t=t||0,this.scrollerStyle[o.style.transitionDuration]=t+"ms",!t&&o.isBadAndroid&&(this.scrollerStyle[o.style.transitionDuration]="0.001s")},_transitionTimingFunction:function(t){this.scrollerStyle[o.style.transitionTimingFunction]=t},_translate:function(t,e){this.options.useTransform?this.translateZ?this.scrollerStyle[o.style.transform]="translate3d("+t+"px,"+e+"px, 0)":this.scrollerStyle[o.style.transform]="translate("+t+"px,"+e+"px)":(t=i.round(t),e=i.round(e),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=e+"px"),this.x=t,this.y=e},_initEvents:function(e){var i=e?o.removeEvent:o.addEvent,s=this.options.bindToWrapper?this.wrapper:t;i(t,"orientationchange",this),i(t,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(s,"mousemove",this),i(s,"mousecancel",this),i(s,"mouseup",this)),o.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,"MSPointerDown",this),i(s,"MSPointerMove",this),i(s,"MSPointerCancel",this),i(s,"MSPointerUp",this)),o.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(s,"touchmove",this),i(s,"touchcancel",this),i(s,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e,i,s=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(s=s[o.style.transform].split(")")[0].split(", "),e=+(s[12]||s[4]),i=+(s[13]||s[5])):(e=+s.left.replace(/[^-\d.]/g,""),i=+s.top.replace(/[^-\d.]/g,"")),{x:e,y:i}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,e,s,n,o,r,a=0,h=0,c=0,l=this.options.snapStepX||this.wrapperWidth,p=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(s=i.round(l/2),n=i.round(p/2);c>-this.scrollerWidth;){for(this.pages[a]=[],t=0,o=0;o>-this.scrollerHeight;)this.pages[a][t]={x:i.max(c,this.maxScrollX),y:i.max(o,this.maxScrollY),width:l,height:p,cx:c-s,cy:o-n},o-=p,t++;c-=l,a++}else for(r=this.options.snap,t=r.length,e=-1;t>a;a++)(0===a||r[a].offsetLeft<=r[a-1].offsetLeft)&&(h=0,e++),this.pages[h]||(this.pages[h]=[]),c=i.max(-r[a].offsetLeft,this.maxScrollX),o=i.max(-r[a].offsetTop,this.maxScrollY),s=c-i.round(r[a].offsetWidth/2),n=o-i.round(r[a].offsetHeight/2),this.pages[h][e]={x:c,y:o,width:r[a].offsetWidth,height:r[a].offsetHeight,cx:s,cy:n},c>this.maxScrollX&&h++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var s=0,n=this.pages.length,o=0;if(i.abs(t-this.absStartX)<this.snapThresholdX&&i.abs(e-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),e>0?e=0:e<this.maxScrollY&&(e=this.maxScrollY);n>s;s++)if(t>=this.pages[s][0].cx){t=this.pages[s][0].x;break}for(n=this.pages[s].length;n>o;o++)if(e>=this.pages[0][o].cy){e=this.pages[0][o].y;break}return s==this.currentPage.pageX&&(s+=this.directionX,0>s?s=0:s>=this.pages.length&&(s=this.pages.length-1),t=this.pages[s][0].x),o==this.currentPage.pageY&&(o+=this.directionY,0>o?o=0:o>=this.pages[0].length&&(o=this.pages[0].length-1),e=this.pages[0][o].y),{x:t,y:e,pageX:s,pageY:o}},goToPage:function(t,e,s,n){n=n||this.options.bounceEasing,t>=this.pages.length&&(t=this.pages.length-1),0>t&&(t=0),e>=this.pages[t].length&&(e=this.pages[t].length-1),0>e&&(e=0);var o=this.pages[t][e].x,r=this.pages[t][e].y;s=void 0===s?this.options.snapSpeed||i.max(i.max(i.min(i.abs(o-this.x),1e3),i.min(i.abs(r-this.y),1e3)),300):s,this.currentPage={x:o,y:r,pageX:t,pageY:e},this.scrollTo(o,r,s,n)},next:function(t,e){var i=this.currentPage.pageX,s=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,s++),this.goToPage(i,s,t,e)},prev:function(t,e){var i=this.currentPage.pageX,s=this.currentPage.pageY;i--,0>i&&this.hasVerticalScroll&&(i=0,s--),this.goToPage(i,s,t,e)},_animate:function(t,e,i,s){function r(){var u,d,m,f=o.getTime();return f>=p?(a.isAnimating=!1,a._translate(t,e),void(a.resetPosition(a.options.bounceTime)||a._execEvent("scrollEnd"))):(f=(f-l)/i,m=s(f),u=(t-h)*m+h,d=(e-c)*m+c,a._translate(u,d),a.isAnimating&&n(r),void(a.options.probeType>=3&&a._execEvent("scroll")))}var a=this,h=this.x,c=this.y,l=o.getTime(),p=l+i;this.isAnimating=!0,r()},handleEvent:function(t){switch(t.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":t._constructed||(t.preventDefault(),t.stopPropagation())}}},s.utils=o,"undefined"!=typeof module&&module.exports?module.exports=s:t.IScroll=s}(window,document,Math),window.FixClickThrough&&window.FixClickThrough.bind("click",function(t){return!!t._constructed}),window.iScroll=window.IScroll},{requires:["touch"]});KISSY.add("h5-home/widgets/orientation/index",function(t){function e(t){var e,i={};if(t)for(e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function i(t,e){return t.bind?t.bind(e):function(){t.apply(e,arguments)}}function n(){this.init.apply(this,arguments)}var s="orientationchange",o="resize",r="onorientationchange"in window?s:o,a="function",h="on",c="after";return n.prototype={constructor:n,init:function(t){this._cfg=e({delay:400},t),this._subs={on:[],after:[]},this.info=this.getInfo(),this._onWinOrientationChange=i(this._onWinOrientationChange,this),window.addEventListener(r,this._onWinOrientationChange,!1)},destroy:function(){window.removeEventListener(r,this._onWinOrientationChange,!1),delete this._subs},create:function(t){return new n(t)},getInfo:function(){return r===s?{landscape:90==window.orientation||-90==window.orientation,portrait:0==window.orientation||-180==window.orientation,orientation:window.orientation}:{landscape:window.screen.width>window.screen.height,portrait:window.screen.width<=window.screen.height,orientation:window.screen.width>window.screen.height?90:0}},isLandscape:function(){return this.info.landscape},isPortrait:function(){return this.info.portrait},change:function(t,e){return typeof t===a&&this._subs[e?c:h].push(t),this},_fireChange:function(t){var i,n,s=this,o=this.getInfo(),r=this._subs;if(o.landscape!==this.info.landscape){for(this.info=e(o),o.originEvent=t,o.originType=t.type,i=0,n=r.on.length;n>i;i++)r.on[i].call(s,t);setTimeout(function(){for(i=0,n=r.after.length;n>i;i++)r.after[i].call(s,t)},0)}},_checkChange:function(t){var e=this;e._cfg.delay?(clearTimeout(this._changeTimer),e._changeTimer=setTimeout(function(){e._fireChange(t)},e._cfg.delay)):e._fireChange(t)},_onWinOrientationChange:function(t){t.type==o?this._fireChange(t):this._checkChange(t)}},n.prototype.create()});KISSY.add("h5-home/pages/home/mods/headline/index",function(t,require,e,i){var n=require("../../../../widgets/simple-slide/"),s=require("../../../../widgets/orientation/");i.exports={id:"trip_home_discovery_headline",init:function(e){(!this.rendered||this.destroyed)&&(this.host=e,this.container=t.one(".headline"),this.container&&this.render())},render:function(){var t=this.container.all("li"),e=t.length,i=this;e>1&&i.renderSlide(e),this.rendered=!0},renderSlide:function(e){var i=this;this.slide=new n({container:".headline-list",items:"li",height:t.one(".headline-list")[0].clientHeight,vertical:!0,circular:!0,autoPlay:!0,timeout:5e3}),this.slide.render(),this.slide.stop(),setTimeout(function(){i.slide.play()},2500),this.orientation=s.create(),this.orientation.change(function(t){i.slide.refresh(),i.slide.play()},!0)},destroy:function(){this.slide&&this.slide.stop(),this.slide&&this.slide.destroy(),this.orientation&&this.orientation.destroy(),this.slide=null,this.orientation=null,this.destroyed=!0}}});KISSY.add("h5-home/pages/home/mods/onsale/index",function(t,require,e,i){var n=require("juicer"),s=require("../../../../widgets/count-down/");i.exports={id:"trip_home_channel_onsale",init:function(e,i){this.destroyed=this.rendered=!1,this.host=e,this.webp=e.isSupportWebp,this.tpl=window.ALITRIP_H5_HOME_TPLS.J_tpl_trip_home_channel_onsale,this.container=t.one(".channel-cell-onsale a"),i&&(this.data=i,this.render())},render:function(){var t,e=this.data;t=this.getItem(e),t&&this.renderCountDown(t),this.rendered=!0},renderCountDown:function(t){var e=this,i=n(this.tpl,{item:{itemName:t.description,price:t.goodsPrice,image:t.rightImage,imageTag:t.serviceLabelImage,started:t.countDownStarted,beforeStartText:t.activityBeforeCountDownReminder||"\u5373\u5c06\u5f00\u59cb",prefix:t.currencySign||"\uffe5"}});this.container.html(i),this.countDown&&this.countDown.destroy(),t.countDownStarted&&(this.countDown=new s({node:".channel-countdown",left:t.countDownLeft,onEnd:function(){e.render()}}))},renderPlaceHolder:function(){},getItem:function(t){var e=t.serverTime||Date.now(),i=[];return t.activityList&&(i=t.activityList.filter(function(t){return t.activityStartTime=Number(t.activityStartTime)||0,t.activityOngoingTime=Number(t.activityOngoingTime)||0,t.activityEndTime=t.activityStartTime+t.activityOngoingTime,t.countDownLeft=t.activityEndTime-e,t.countDownStarted=t.activityStartTime-e<=0,t.activityEndTime&&t.countDownLeft>0?!0:void 0})),i[0]},destroy:function(){this.countDown&&this.countDown.destroy(),this.countDown=null,this.destroyed=!0}}});KISSY.add("h5-home/widgets/count-down/index",function(t,e){function i(){this.init.apply(this,arguments)}return t.augment(i,{init:function(e){this.cfg=e=e||{},this.node=t.one(e.node),this.hour=this.node.one(".cd-hour"),this.minute=this.node.one(".cd-minute"),this.second=this.node.one(".cd-second"),this.update()},destroy:function(){this.stop(),this.node=null,this.hour=null,this.minute=null,this.second=null},update:function(e){this.cfg=e=e?t.merge(this.cfg,e):this.cfg,this.stop(),this.timeFormatter=e.timeFormatter||this.defTimeFormatter,this.onStart=e.onStart,this.onCountDown=e.onCountDown,this.onEnd=e.onEnd,this.now={},this.prev={},this.leftTime=e.left>=0?e.left:0,this.startTime=Date.now(),this.start()},getTime:function(t){var t=t>0?t:0,e=Math.round(t/1e3),i=Math.floor(e/3600),n=Math.floor(e%3600/60),s=e%3600%60,r=Math.floor(i/10),a=Math.floor(n/10),o=Math.floor(s/10),c=i%10,h=n%10,l=s%10,d=""+r+c,u=""+a+h,p=""+o+l;return{h:i,hd:r,hu:c,hs:d,m:n,md:a,mu:h,ms:u,s:s,sd:o,su:l,ss:p}},isEnd:function(){return!(this.now.h>0||this.now.m>0||this.now.s>0)},start:function(){var t=this;return this.stop(),"function"==typeof this.onStart&&this.onStart(),this.countDown(!0),this.timer=setInterval(function(){t.countDown()},1e3),this},stop:function(){this.timer&&(clearInterval(this.timer),delete this.timer)},end:function(){return this.stop(),"function"==typeof this.onEnd&&this.onEnd(),this},countDown:function(t){var e=Date.now()-this.startTime,i=this.leftTime-e,n=this.prev=this.now,s=this.now=this.getTime(i);return s.s!==n.s&&this.setSecond(s.ss,s.s,s),s.m!==n.m&&this.setMinute(s.ms,s.m,s),s.h!==n.h&&this.setHour(s.hs,s.h,s),t||"function"!=typeof this.onCountDown||this.onCountDown(),this.isEnd()&&this.end(),this},setHour:function(){return this.hour.html(this.timeFormatter.apply(this,arguments)),this},setMinute:function(){return this.minute.html(this.timeFormatter.apply(this,arguments)),this},setSecond:function(){return this.second.html(this.timeFormatter.apply(this,arguments)),this},defTimeFormatter:function(t,e,i){return t}}),i},{requires:["node"]});KISSY.add("h5-home/pages/home/mods/favor/index",function(t,require,e,i){var n=require("juicer"),s=require("mtop"),r=require("ua"),o=require("q"),a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},h=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){window.clearTimeout(t)};i.exports={id:"trip_home_guess_favor_contents",init:function(t,e){this.host=t,this.destroyed=this.rendered=this.isLoading=this.isEnd=!1,this.pageNo=1,this.currentSize=0,this.clickedData=[],t.renderCount>=2&&(this.titleTpl=window.ALITRIP_H5_HOME_TPLS.J_tpl_trip_home_guess_favor_title_bar,this.listTpl=window.ALITRIP_H5_HOME_TPLS.J_tpl_trip_home_guess_favor_contents,this.itemTpl=window.ALITRIP_H5_HOME_TPLS.J_tpl_trip_home_guess_favor_contents_item,this.render())},destroy:function(){this.detachScroll(),this.detachClick(),this.title&&this.title.remove(),this.listContainer&&this.listContainer.remove(),this.list=null,this.title=null,this.loading=null,this.listContainer=null,this.footer=null,this.margin=null,this.currentSize=0,this.destroyed=!0},render:function(){this.footer=window.isInAlipay?t.one(".footer"):t.one(".tabbar"),this.margin=this.footer?this.footer.offset().height+100:175,this.load(),this.bindScroll(),this.rendered=!0},bindClick:function(){this.list&&this.list.delegate("tap",".favor-item",this._onItemClick,this),this.loading&&this.loading.on("tap",this._onLoadingClick,this)},detachClick:function(){this.list&&this.list.detach("tap",".favor-item",this._onItemClick,this),this.loading&&this.loading.detach("tap",this._onLoadingClick,this)},bindScroll:function(){this.detachScroll(),this.checkScroll(),r.ios&&t.one(window).on("touchmove",this.checkScroll,this),t.one(window).on("scroll",this.checkScroll,this)},detachScroll:function(){r.ios&&t.one(window).detach("touchmove",this.checkScroll,this),t.one(window).detach("scroll",this.checkScroll,this),this.rid&&h(this.rid),this.rid=null},checkScroll:function(){var t=this,e=this.margin,i=function(){t.destroyed||t.isLoading||t.isEnd||document.body.scrollHeight-window.innerHeight-window.pageYOffset<=e&&t.load()};this.rid&&h(this.rid),this.rid=null,r.ios?i():this.rid=a(i)},load:function(){var t=this;this.isLoading=!0,this.fetchData().then(function(e){t.pageNo++,t.commonData=e.common,e.sections.forEach(function(i){t.renderSection(i,e.common,t.pageNo-2)}),t.host.lazyload.update(),t.isLoading=!1,e.common&&e.common.isBottom?(t.isEnd=!0,t.detachScroll(),t.loading&&t.loading.addClass("hidden"),t.host.sendExposureDataToGoldLog()):t.checkScroll()},function(){t.isLoading=!1,t.loading&&(t.detachScroll(),t.loading.html("\u52a0\u8f7d\u5931\u8d25\uff0c\u70b9\u51fb\u91cd\u8bd5"),t.loading.addClass("favor-loading-failed"))})},renderSection:function(e,i){var s="";"trip_home_guess_favor_title_bar"===e.id?(s=n(this.titleTpl,e),this.footer.before(s),this.title=t.one(".trip_home_guess_favor_title_bar")):"trip_home_guess_favor_contents"===e.id&&(this.list||(this.footer.before(this.listTpl),this.listContainer=t.one(".trip_home_guess_favor_contents"),this.loading=this.listContainer.one(".favor-loading"),this.list=this.listContainer.one("ul"),this.bindClick()),s=n(this.itemTpl,{items:e&&e.items||[],current:this.currentSize}),this.currentSize+=(e&&e.items||[]).length,this.list.append(s))},fetchData:function(){var t=this,e=o.defer(),i=this.host.requestId,n=this.host.currentCity||{},r=this.commonData,a=this.clickedData,h=this.pageNo;return s.getApi("mtop.trip.uilayout.queryUILayout","1.0",{uiLayoutName:"qua_home_guess_you_like",uiLayoutVersion:"1.0",clientPlatform:"h5",userCityType:"0",userCity:n.cityName,userCityCode:n.cityCode||"",userLng:n.longitude||"",userLat:n.latitude||"",requestId:r&&r.requestId||"",extraParams:JSON.stringify({pageNo:h,clickedData:a?JSON.stringify(a):"[]"})},{},function(n){i===t.host.requestId&&(n&&n.data&&n.data.sections&&n.data.sections.length?e.resolve(n.data):e.reject(n))},function(n){i===t.host.requestId&&e.reject(n)}),e.promise},_onItemClick:function(t){var e=t.currentTarget.getAttribute("data-uniqueid")||"";e&&this.clickedData.push(e),this.clickedData.length>6&&this.clickedData.shift()},_onLoadingClick:function(t){this.loading&&this.loading.hasClass("favor-loading-failed")&&(this.bindScroll(),this.loading.html("\u52a0\u8f7d\u66f4\u591a..."),this.loading.removeClass("favor-loading-failed"))}}});